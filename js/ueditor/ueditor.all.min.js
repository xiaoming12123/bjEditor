/*!
 * UEditor
 * version: ueditor
 * build: Wed Aug 10 2016 11:06:02 GMT+0800 (CST)
 */
(function(){function l(e,t,n){var r;return t=t.toLowerCase(),(r=e.__allListeners||n&&(e.__allListeners={}))&&(r[t]||n&&(r[t]=[]))}function h(e,t,n,r,i,s){var o=r&&e[t],u;!o&&(o=e[n]);while(!o&&(u=(u||e).parentNode)){if(u.tagName=="BODY"||s&&!s(u))return null;o=u[n]}return o&&i&&!i(o)?h(o,t,n,!1,i):o}UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};var e=window.baidu||{};window.baidu=e,window.UE=e.editor=window.UE||{},UE.plugins={},UE.commands={},UE.instants={},UE.I18N={},UE.version="1.4.3";var t=UE.dom={},n=UE.browser=function(){var e=navigator.userAgent.toLowerCase(),t=window.opera,n={ie:/(msie\s|trident.*rv:)([\w.]+)/.test(e),opera:!!t&&t.version,webkit:e.indexOf(" applewebkit/")>-1,mac:e.indexOf("macintosh")>-1,quirks:document.compatMode=="BackCompat"};n.gecko=navigator.product=="Gecko"&&!n.webkit&&!n.opera&&!n.ie;var r=0;if(n.ie){var i=e.match(/(?:msie\s([\w.]+))/),s=e.match(/(?:trident.*rv:([\w.]+))/);i&&s&&i[1]&&s[1]?r=Math.max(i[1]*1,s[1]*1):i&&i[1]?r=i[1]*1:s&&s[1]?r=s[1]*1:r=0,n.ie11Compat=document.documentMode==11,n.ie9Compat=document.documentMode==9,n.ie8=!!document.documentMode,n.ie8Compat=document.documentMode==8,n.ie7Compat=r==7&&!document.documentMode||document.documentMode==7,n.ie6Compat=r<7||n.quirks,n.ie9above=r>8,n.ie9below=r<9,n.ie11above=r>10,n.ie11below=r<11}if(n.gecko){var o=e.match(/rv:([\d\.]+)/);o&&(o=o[1].split("."),r=o[0]*1e4+(o[1]||0)*100+(o[2]||0)*1)}return/chrome\/(\d+\.\d)/i.test(e)&&(n.chrome=+RegExp.$1),/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(e)&&!/chrome/i.test(e)&&(n.safari=+(RegExp.$1||RegExp.$2)),n.opera&&(r=parseFloat(t.version())),n.webkit&&(r=parseFloat(e.match(/ applewebkit\/(\d+)/)[1])),n.version=r,n.isCompatible=!n.mobile&&(n.ie&&r>=6||n.gecko&&r>=10801||n.opera&&r>=9.5||n.air&&r>=1||n.webkit&&r>=522||!1),n}(),r=n.ie,s=n.webkit,o=n.gecko,u=n.opera,a=UE.utils={each:function(e,t,n){if(e==null)return;if(e.length===+e.length){for(var r=0,i=e.length;r<i;r++)if(t.call(n,e[r],r,e)===!1)return!1}else for(var s in e)if(e.hasOwnProperty(s)&&t.call(n,e[s],s,e)===!1)return!1},makeInstance:function(e){var t=new Function;return t.prototype=e,e=new t,t.prototype=null,e},extend:function(e,t,n){if(t)for(var r in t)if(!n||!e.hasOwnProperty(r))e[r]=t[r];return e},extend2:function(e){var t=arguments;for(var n=1;n<t.length;n++){var r=t[n];for(var i in r)e.hasOwnProperty(i)||(e[i]=r[i])}return e},inherits:function(e,t){var n=e.prototype,r=a.makeInstance(t.prototype);return a.extend(r,n,!0),e.prototype=r,r.constructor=e},bind:function(e,t){return function(){return e.apply(t,arguments)}},defer:function(e,t,n){var r;return function(){n&&clearTimeout(r),r=setTimeout(e,t)}},indexOf:function(e,t,n){var r=-1;return n=this.isNumber(n)?n:0,this.each(e,function(e,i){if(i>=n&&e===t)return r=i,!1}),r},removeItem:function(e,t){for(var n=0,r=e.length;n<r;n++)e[n]===t&&(e.splice(n,1),n--)},trim:function(e){return e.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(e){if(!e)return{};e=a.isArray(e)?e:e.split(",");for(var t=0,n,r={};n=e[t++];)r[n.toUpperCase()]=r[n]=1;return r},unhtml:function(e,t){return e?e.replace(t||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp|#\d+);)?/g,function(e,t){return t?e:{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[e]}):""},unhtmlForUrl:function(e,t){return e?e.replace(t||/[<">']/g,function(e){return{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[e]}):""},html:function(e){return e?e.replace(/&((g|l|quo)t|amp|#39|nbsp);/g,function(e){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">","&#39;":"'","&nbsp;":" "}[e]}):""},cssStyleToDomStyle:function(){var e=document.createElement("div").style,t={"float":e.cssFloat!=undefined?"cssFloat":e.styleFloat!=undefined?"styleFloat":"float"};return function(e){return t[e]||(t[e]=e.toLowerCase().replace(/-./g,function(e){return e.charAt(1).toUpperCase()}))}}(),loadFile:function(){function t(t,n){try{for(var r=0,i;i=e[r++];)if(i.doc===t&&i.url==(n.src||n.href))return i}catch(s){return null}}var e=[];return function(n,r,i){var s=t(n,r);if(s){s.ready?i&&i():s.funs.push(i);return}e.push({doc:n,url:r.src||r.href,funs:[i]});if(!n.body){var o=[];for(var u in r){if(u=="tag")continue;o.push(u+'="'+r[u]+'"')}n.write("<"+r.tag+" "+o.join(" ")+" ></"+r.tag+">");return}if(r.id&&n.getElementById(r.id))return;var a=n.createElement(r.tag);delete r.tag;for(var u in r)a.setAttribute(u,r[u]);a.onload=a.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){s=t(n,r);if(s.funs.length>0){s.ready=1;for(var e;e=s.funs.pop();)e()}a.onload=a.onreadystatechange=null}},a.onerror=function(){throw Error("The load "+(r.href||r.src)+" fails,check the url settings of file ueditor.config.js ")},n.getElementsByTagName("head")[0].appendChild(a)}}(),isEmptyObject:function(e){if(e==null)return!0;if(this.isArray(e)||this.isString(e))return e.length===0;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},fixColor:function(e,t){if(/color/i.test(e)&&/rgba?/.test(t)){var n=t.split(",");if(n.length>3)return"";t="#";for(var r=0,i;i=n[r++];)i=parseInt(i.replace(/[^\d]/gi,""),10).toString(16),t+=i.length==1?"0"+i:i;t=t.toUpperCase()}return t},optCss:function(e){function i(e,t){if(!e)return"";var n=e.top,r=e.bottom,i=e.left,s=e.right,o="";if(!n||!i||!r||!s)for(var u in e)o+=";"+t+"-"+u+":"+e[u]+";";else o+=";"+t+":"+(n==r&&r==i&&i==s?n:n==r&&i==s?n+" "+i:i==s?n+" "+i+" "+r:n+" "+s+" "+r+" "+i)+";";return o}var t,n,r;return e=e.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(e,r,i,s){if(s.split(" ").length==1)switch(r){case"padding":return!t&&(t={}),t[i]=s,"";case"margin":return!n&&(n={}),n[i]=s,"";case"border":return s=="initial"?"":e}return e}),e+=i(t,"padding")+i(n,"margin"),e.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(e,t){return t?t+";;":";"})},clone:function(e,t){var n;t=t||{};for(var r in e)e.hasOwnProperty(r)&&(n=e[r],typeof n=="object"?(t[r]=a.isArray(n)?[]:{},a.clone(e[r],t[r])):t[r]=n);return t},transUnitToPx:function(e){if(!/(pt|cm)/.test(e))return e;var t;e.replace(/([\d.]+)(\w+)/,function(n,r,i){e=r,t=i});switch(t){case"cm":e=parseFloat(e)*25;break;case"pt":e=Math.round(parseFloat(e)*96/72)}return e+(e?"px":"")},domReady:function(){function t(t){t.isReady=!0;for(var n;n=e.pop();n());}var e=[];return function(r,i){i=i||window;var s=i.document;r&&e.push(r),s.readyState==="complete"?t(s):(s.isReady&&t(s),n.ie&&n.version!=11?(function(){if(s.isReady)return;try{s.documentElement.doScroll("left")}catch(e){setTimeout(arguments.callee,0);return}t(s)}(),i.attachEvent("onload",function(){t(s)})):(s.addEventListener("DOMContentLoaded",function(){s.removeEventListener("DOMContentLoaded",arguments.callee,!1),t(s)},!1),i.addEventListener("load",function(){t(s)},!1)))}}(),cssRule:n.ie&&n.version!=11?function(e,t,n){var r,i;if(t===undefined||t&&t.nodeType&&t.nodeType==9)return n=t&&t.nodeType&&t.nodeType==9?t:n||document,r=n.indexList||(n.indexList={}),i=r[e],i!==undefined?n.styleSheets[i].cssText:undefined;n=n||document,r=n.indexList||(n.indexList={}),i=r[e];if(t==="")return i!==undefined?(n.styleSheets[i].cssText="",delete r[e],!0):!1;i!==undefined?sheetStyle=n.styleSheets[i]:(sheetStyle=n.createStyleSheet("",i=n.styleSheets.length),r[e]=i),sheetStyle.cssText=t}:function(e,t,n){var r,i;if(t===undefined||t&&t.nodeType&&t.nodeType==9)return n=t&&t.nodeType&&t.nodeType==9?t:n||document,i=n.getElementById(e),i?i.innerHTML:undefined;n=n||document,i=n.getElementById(e);if(t==="")return i?(i.parentNode.removeChild(i),!0):!1;i?i.innerHTML=t:(i=n.createElement("style"),i.id=e,i.innerHTML=t,n.getElementsByTagName("head")[0].appendChild(i))},sort:function(e,t){t=t||function(e,t){return e.localeCompare(t)};for(var n=0,r=e.length;n<r;n++)for(var i=n,s=e.length;i<s;i++)if(t(e[n],e[i])>0){var o=e[n];e[n]=e[i],e[i]=o}return e},serializeParam:function(e){var t=[];for(var n in e){if(n=="method"||n=="timeout"||n=="async")continue;if((typeof e[n]).toLowerCase()!="function"&&(typeof e[n]).toLowerCase()!="object")t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));else if(a.isArray(e[n]))for(var r=0;r<e[n].length;r++)t.push(encodeURIComponent(n)+"[]="+encodeURIComponent(e[n][r]))}return t.join("&")},formatUrl:function(e){var t=e.replace(/&&/g,"&");return t=t.replace(/\?&/g,"?"),t=t.replace(/&$/g,""),t=t.replace(/&#/g,"#"),t=t.replace(/&+/g,"&"),t},isCrossDomainUrl:function(e){var t=document.createElement("a");return t.href=e,n.ie&&(t.href=t.href),t.protocol!=location.protocol||t.hostname!=location.hostname||!(t.port==location.port||t.port=="80"&&location.port==""||t.port==""&&location.port=="80")},clearEmptyAttrs:function(e){for(var t in e)e[t]===""&&delete e[t];return e},str2json:function(e){return a.isString(e)?window.JSON?JSON.parse(e):(new Function("return "+a.trim(e||"")))():null},json2str:function(){if(window.JSON)return JSON.stringify;var e={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function t(t){return/["\\\x00-\x1f]/.test(t)&&(t=t.replace(/["\\\x00-\x1f]/g,function(t){var n=e[t];return n?n:(n=t.charCodeAt(),"\\u00"+Math.floor(n/16).toString(16)+(n%16).toString(16))})),'"'+t+'"'}function n(e){var t=["["],n=e.length,r,i,s;for(i=0;i<n;i++){s=e[i];switch(typeof s){case"undefined":case"function":case"unknown":break;default:r&&t.push(","),t.push(a.json2str(s)),r=1}}return t.push("]"),t.join("")}function r(e){return e<10?"0"+e:e}function i(e){return'"'+e.getFullYear()+"-"+r(e.getMonth()+1)+"-"+r(e.getDate())+"T"+r(e.getHours())+":"+r(e.getMinutes())+":"+r(e.getSeconds())+'"'}return function(e){switch(typeof e){case"undefined":return"undefined";case"number":return isFinite(e)?String(e):"null";case"string":return t(e);case"boolean":return String(e);default:if(e===null)return"null";if(a.isArray(e))return n(e);if(a.isDate(e))return i(e);var r=["{"],s=a.json2str,o,u;for(var f in e)if(Object.prototype.hasOwnProperty.call(e,f)){u=e[f];switch(typeof u){case"undefined":case"unknown":case"function":break;default:o&&r.push(","),o=1,r.push(s(f)+":"+s(u))}}return r.push("}"),r.join("")}}}()};a.each(["String","Function","Array","Number","RegExp","Object","Date"],function(e){UE.utils["is"+e]=function(t){return Object.prototype.toString.apply(t)=="[object "+e+"]"}});var f=UE.EventBase=function(){};f.prototype={addListener:function(e,t){e=a.trim(e).split(/\s+/);for(var n=0,r;r=e[n++];)l(this,r,!0).push(t)},on:function(e,t){return this.addListener(e,t)},off:function(e,t){return this.removeListener(e,t)},trigger:function(){return this.fireEvent.apply(this,arguments)},removeListener:function(e,t){e=a.trim(e).split(/\s+/);for(var n=0,r;r=e[n++];)a.removeItem(l(this,r)||[],t)},fireEvent:function(){var e=arguments[0];e=a.trim(e).split(" ");for(var t=0,n;n=e[t++];){var r=l(this,n),i,s,o;if(r){o=r.length;while(o--){if(!r[o])continue;s=r[o].apply(this,arguments);if(s===!0)return s;s!==undefined&&(i=s)}}if(s=this["on"+n.toLowerCase()])i=s.apply(this,arguments)}return i}};var c=t.dtd=function(){function e(e){for(var t in e)e[t.toUpperCase()]=e[t];return e}var t=a.extend2,n=e({isindex:1,fieldset:1}),r=e({input:1,button:1,select:1,textarea:1,label:1}),i=t(e({a:1}),r),s=t({iframe:1},i),o=e({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),u=e({ins:1,del:1,script:1,style:1}),f=t(e({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),u),l=t(e({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),f),c=t(e({p:1}),l),h=t(e({iframe:1}),l,r),p=e({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),d=t(e({a:0}),h),v=e({tr:1}),m=e({"#":1}),g=t(e({param:1}),p),y=t(e({form:1}),n,s,o,c),b=e({li:1,ol:1,ul:1}),w=e({style:1,script:1}),E=e({base:1,link:1,meta:1,title:1}),S=t(E,w),x=e({head:1,body:1}),T=e({html:1}),N=e({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),C=e({area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1});return e({$nonBodyContent:t(T,x,E),$block:N,$inline:d,$inlineWithA:t(e({a:1}),d),$body:t(e({script:1,style:1}),N),$cdata:e({script:1,style:1}),$empty:C,$nonChild:e({iframe:1,textarea:1}),$listItem:e({dd:1,dt:1,li:1}),$list:e({ul:1,ol:1,dl:1}),$isNotEmpty:e({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:e({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:e({p:1,div:1}),$tableContent:e({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:e({pre:1,script:1,style:1,textarea:1}),html:x,head:S,style:m,script:m,body:y,base:{},link:{},meta:{},title:m,col:{},tr:e({td:1,th:1}),img:{},embed:{},colgroup:e({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:y,td:y,br:{},th:y,center:y,kbd:d,button:t(c,o),basefont:{},h5:d,h4:d,samp:d,h6:d,ol:b,h1:d,h3:d,option:m,h2:d,form:t(n,s,o,c),select:e({optgroup:1,option:1}),font:d,ins:d,menu:b,abbr:d,label:d,table:e({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:d,tfoot:v,cite:d,li:y,input:{},iframe:y,strong:d,textarea:m,noframes:y,big:d,small:d,span:e({"#":1,br:1,b:1,strong:1,u:1,i:1,em:1,sub:1,sup:1,strike:1,span:1}),hr:d,dt:d,sub:d,optgroup:e({option:1}),param:{},bdo:d,"var":d,div:y,object:g,sup:d,dd:y,strike:d,area:{},dir:b,map:t(e({area:1,form:1,p:1}),n,u,o),applet:g,dl:e({dt:1,dd:1}),del:d,isindex:{},fieldset:t(e({legend:1}),p),thead:v,ul:b,acronym:d,b:d,a:t(e({a:1}),h),blockquote:t(e({td:1,tr:1,tbody:1,li:1}),y),caption:d,i:d,u:d,tbody:v,s:d,address:t(s,c),tt:d,legend:d,q:d,pre:t(f,i),p:t(e({a:1}),d),em:d,dfn:d})}(),p=r&&n.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},d=a.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]),v=t.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:r&&n.version=="6"?"﻿":"​",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(e,t){if(e===t)return 0;var n,r=[e],i=[t];n=e;while(n=n.parentNode){if(n===t)return 10;r.push(n)}n=t;while(n=n.parentNode){if(n===e)return 20;i.push(n)}r.reverse(),i.reverse();if(r[0]!==i[0])return 1;var s=-1;while(s++,r[s]===i[s]);e=r[s],t=i[s];while(e=e.nextSibling)if(e===t)return 4;return 2},getNodeIndex:function(e,t){var n=e,r=0;while(n=n.previousSibling){if(t&&n.nodeType==3){n.nodeType!=n.nextSibling.nodeType&&r++;continue}r++}return r},inDoc:function(e,t){return v.getPosition(e,t)==10},findParent:function(e,t,n){if(e&&!v.isBody(e)){e=n?e:e.parentNode;while(e){if(!t||t(e)||v.isBody(e))return t&&!t(e)&&v.isBody(e)?null:e;e=e.parentNode}}return null},findParentByTagName:function(e,t,n,r){return t=a.listToMap(a.isArray(t)?t:[t]),v.findParent(e,function(e){return t[e.tagName]&&(!r||!r(e))},n)},findParents:function(e,t,n,r){var i=t&&(n&&n(e)||!n)?[e]:[];while(e=v.findParent(e,n))i.push(e);return r?i:i.reverse()},insertAfter:function(e,t){return e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t)},remove:function(e,t){var n=e.parentNode,r;if(n){if(t&&e.hasChildNodes())while(r=e.firstChild)n.insertBefore(r,e);n.removeChild(e)}return e},getNextDomNode:function(e,t,n,r){return h(e,"firstChild","nextSibling",t,n,r)},getPreDomNode:function(e,t,n,r){return h(e,"lastChild","previousSibling",t,n,r)},isBookmarkNode:function(e){return e.nodeType==1&&e.id&&/^_baidu_bookmark_/i.test(e.id)},getWindow:function(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow},getCommonAncestor:function(e,t){if(e===t)return e;var n=[e],r=[t],i=e,s=-1;while(i=i.parentNode){if(i===t)return i;n.push(i)}i=t;while(i=i.parentNode){if(i===e)return i;r.push(i)}n.reverse(),r.reverse();while(s++,n[s]===r[s]);return s==0?null:n[s-1]},clearEmptySibling:function(e,t,n){function r(e,t){var n;while(e&&!v.isBookmarkNode(e)&&(v.isEmptyInlineElement(e)||!(new RegExp("[^	\n\r"+v.fillChar+"]")).test(e.nodeValue)))n=e[t],v.remove(e),e=n}!t&&r(e.nextSibling,"nextSibling"),!n&&r(e.previousSibling,"previousSibling")},split:function(e,t){var r=e.ownerDocument;if(n.ie&&t==e.nodeValue.length){var i=r.createTextNode("");return v.insertAfter(e,i)}var s=e.splitText(t);if(n.ie8){var o=r.createTextNode("");v.insertAfter(s,o),v.remove(o)}return s},isWhitespace:function(e){return!(new RegExp("[^ 	\n\r"+v.fillChar+"]")).test(e.nodeValue)},getXY:function(e){var t=0,n=0;while(e.offsetParent)n+=e.offsetTop,t+=e.offsetLeft,e=e.offsetParent;return{x:t,y:n}},on:function(e,t,n){var r=a.isArray(t)?t:a.trim(t).split(/\s+/),i=r.length;if(i)while(i--){t=r[i];if(e.addEventListener)e.addEventListener(t,n,!1);else{n._d||(n._d={els:[]});var s=t+n.toString(),o=a.indexOf(n._d.els,e);if(!n._d[s]||o==-1)o==-1&&n._d.els.push(e),n._d[s]||(n._d[s]=function(e){return n.call(e.srcElement,e||window.event)}),e.attachEvent("on"+t,n._d[s])}}e=null},un:function(e,t,n){var r=a.isArray(t)?t:a.trim(t).split(/\s+/),i=r.length;if(i)while(i--){t=r[i];if(e.removeEventListener)e.removeEventListener(t,n,!1);else{var s=t+n.toString();try{e.detachEvent("on"+t,n._d?n._d[s]:n)}catch(o){}if(n._d&&n._d[s]){var u=a.indexOf(n._d.els,e);u!=-1&&n._d.els.splice(u,1),n._d.els.length==0&&delete n._d[s]}}}},isSameElement:function(e,t){if(e.tagName!=t.tagName)return!1;var n=e.attributes,i=t.attributes;if(!r&&n.length!=i.length)return!1;var s,o,u=0,a=0;for(var f=0;s=n[f++];){if(s.nodeName=="style"){s.specified&&u++;if(v.isSameStyle(e,t))continue;return!1}if(r){if(!s.specified)continue;u++,o=i.getNamedItem(s.nodeName)}else o=t.attributes[s.nodeName];if(!o.specified||s.nodeValue!=o.nodeValue)return!1}if(r){for(f=0;o=i[f++];)o.specified&&a++;if(u!=a)return!1}return!0},isSameStyle:function(e,t){var r=e.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),i=t.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":");if(n.opera){r=e.style,i=t.style;if(r.length!=i.length)return!1;for(var s in r){if(/^(\d+|csstext)$/i.test(s))continue;if(r[s]!=i[s])return!1}return!0}if(!r||!i)return r==i;r=r.split(";"),i=i.split(";");if(r.length!=i.length)return!1;for(var o=0,u;u=r[o++];)if(a.indexOf(i,u)==-1)return!1;return!0},isBlockElm:function(e){return e.nodeType==1&&(c.$block[e.tagName]||d[v.getComputedStyle(e,"display")])&&!c.$nonChild[e.tagName]},isBody:function(e){return e&&e.nodeType==1&&e.tagName.toLowerCase()=="body"},breakParent:function(e,t){var n,r=e,i=e,s,o;do{r=r.parentNode,s?(n=r.cloneNode(!1),n.appendChild(s),s=n,n=r.cloneNode(!1),n.appendChild(o),o=n):(s=r.cloneNode(!1),o=s.cloneNode(!1));while(n=i.previousSibling)s.insertBefore(n,s.firstChild);while(n=i.nextSibling)o.appendChild(n);i=r}while(t!==r);return n=t.parentNode,n.insertBefore(s,t),n.insertBefore(o,t),n.insertBefore(e,o),v.remove(t),e},isEmptyInlineElement:function(e){if(e.nodeType!=1||!c.$removeEmpty[e.tagName])return 0;e=e.firstChild;while(e){if(v.isBookmarkNode(e))return 0;if(e.nodeType==1&&!v.isEmptyInlineElement(e)||e.nodeType==3&&!v.isWhitespace(e))return 0;e=e.nextSibling}return 1},trimWhiteTextNode:function(e){function t(t){var n;while((n=e[t])&&n.nodeType==3&&v.isWhitespace(n))e.removeChild(n)}t("firstChild"),t("lastChild")},mergeChild:function(e,t,n){var r=v.getElementsByTagName(e,e.tagName.toLowerCase());for(var i=0,s;s=r[i++];){if(!s.parentNode||v.isBookmarkNode(s))continue;if(s.tagName.toLowerCase()=="span"){if(e===s.parentNode){v.trimWhiteTextNode(e);if(e.childNodes.length==1){e.style.cssText=s.style.cssText+";"+e.style.cssText,v.remove(s,!0);continue}}s.style.cssText=e.style.cssText+";"+s.style.cssText;if(n){var o=n.style;if(o){o=o.split(";");for(var u=0,f;f=o[u++];)s.style[a.cssStyleToDomStyle(f.split(":")[0])]=f.split(":")[1]}}v.isSameStyle(s,e)&&v.remove(s,!0);continue}v.isSameElement(e,s)&&v.remove(s,!0)}},getElementsByTagName:function(e,t,n){if(n&&a.isString(n)){var r=n;n=function(e){return v.hasClass(e,r)}}t=a.trim(t).replace(/[ ]{2,}/g," ").split(" ");var i=[];for(var s=0,o;o=t[s++];){var u=e.getElementsByTagName(o);for(var f=0,l;l=u[f++];)(!n||n(l))&&i.push(l)}return i},mergeToParent:function(e){var t=e.parentNode;while(t&&c.$removeEmpty[t.tagName]){if(t.tagName==e.tagName||t.tagName=="A"){v.trimWhiteTextNode(t);if(t.tagName=="SPAN"&&!v.isSameStyle(t,e)||t.tagName=="A"&&e.tagName=="SPAN"){if(t.childNodes.length>1||t!==e.parentNode){e.style.cssText=t.style.cssText+";"+e.style.cssText,t=t.parentNode;continue}t.style.cssText+=";"+e.style.cssText,t.tagName=="A"&&(t.style.textDecoration="underline")}if(t.tagName!="A"){t===e.parentNode&&v.remove(e,!0);break}}t=t.parentNode}},mergeSibling:function(e,t,n){function r(e,t,n){var r;if((r=n[e])&&!v.isBookmarkNode(r)&&r.nodeType==1&&v.isSameElement(n,r)){while(r.firstChild)t=="firstChild"?n.insertBefore(r.lastChild,n.firstChild):n.appendChild(r.firstChild);v.remove(r)}}!t&&r("previousSibling","firstChild",e),!n&&r("nextSibling","lastChild",e)},unSelectable:r&&n.ie9below||n.opera?function(e){e.onselectstart=function(){return!1},e.onclick=e.onkeyup=e.onkeydown=function(){return!1},e.unselectable="on",e.setAttribute("unselectable","on");for(var t=0,n;n=e.all[t++];)switch(n.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:n.unselectable="on",e.setAttribute("unselectable","on")}}:function(e){e.style.MozUserSelect=e.style.webkitUserSelect=e.style.msUserSelect=e.style.KhtmlUserSelect="none"},removeAttributes:function(e,t){t=a.isArray(t)?t:a.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var r=0,i;i=t[r++];){i=p[i]||i;switch(i){case"className":e[i]="";break;case"style":e.style.cssText="";var s=e.getAttributeNode("style");!n.ie&&s&&e.removeAttributeNode(s)}e.removeAttribute(i)}},createElement:function(e,t,n){return v.setAttributes(e.createElement(t),n)},setAttributes:function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];switch(n){case"class":e.className=r;break;case"style":e.style.cssText=e.style.cssText+";"+r;break;case"innerHTML":e[n]=r;break;case"value":e.value=r;break;default:e.setAttribute(p[n]||n,r)}}return e},getComputedStyle:function(e,t){var r="width height top left";if(r.indexOf(t)>-1)return e["offset"+t.replace(/^\w/,function(e){return e.toUpperCase()})]+"px";e.nodeType==3&&(e=e.parentNode);if(n.ie&&n.version<9&&t=="font-size"&&!e.style.fontSize&&!c.$empty[e.tagName]&&!c.$nonChild[e.tagName]){var i=e.ownerDocument.createElement("span");i.style.cssText="padding:0;border:0;font-family:simsun;",i.innerHTML=".",e.appendChild(i);var s=i.offsetHeight;return e.removeChild(i),i=null,s+"px"}try{var o=v.getStyle(e,t)||(window.getComputedStyle?v.getWindow(e).getComputedStyle(e,"").getPropertyValue(t):(e.currentStyle||e.style)[a.cssStyleToDomStyle(t)])}catch(u){return""}return a.transUnitToPx(a.fixColor(t,o))},removeClasses:function(e,t){t=a.isArray(t)?t:a.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n=0,r,i=e.className;r=t[n++];)i=i.replace(new RegExp("\\b"+r+"\\b"),"");i=a.trim(i).replace(/[ ]{2,}/g," "),i?e.className=i:v.removeAttributes(e,["class"])},addClass:function(e,t){if(!e)return;t=a.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n=0,r,i=e.className;r=t[n++];)(new RegExp("\\b"+r+"\\b")).test(i)||(i+=" "+r);e.className=a.trim(i)},hasClass:function(e,t){if(a.isRegExp(t))return t.test(e.className);t=a.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n=0,r,i=e.className;r=t[n++];)if(!(new RegExp("\\b"+r+"\\b","i")).test(i))return!1;return n-1==t.length},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},removeStyle:function(e,t){n.ie?(t=="color"&&(t="(^|;)"+t),e.style.cssText=e.style.cssText.replace(new RegExp(t+"[^:]*:[^;]+;?","ig"),"")):e.style.removeProperty?e.style.removeProperty(t):e.style.removeAttribute(a.cssStyleToDomStyle(t)),e.style.cssText||v.removeAttributes(e,["style"])},getStyle:function(e,t){var n=e.style[a.cssStyleToDomStyle(t)];return a.fixColor(t,n)},setStyle:function(e,t,n){e.style[a.cssStyleToDomStyle(t)]=n,a.trim(e.style.cssText)||this.removeAttributes(e,"style")},setStyles:function(e,t){for(var n in t)t.hasOwnProperty(n)&&v.setStyle(e,n,t[n])},removeDirtyAttr:function(e){for(var t=0,n,r=e.getElementsByTagName("*");n=r[t++];)n.removeAttribute("_moz_dirty");e.removeAttribute("_moz_dirty")},getChildCount:function(e,t){var n=0,r=e.firstChild;t=t||function(){return 1};while(r)t(r)&&n++,r=r.nextSibling;return n},isEmptyNode:function(e){return!e.firstChild||v.getChildCount(e,function(e){return!v.isBr(e)&&!v.isBookmarkNode(e)&&!v.isWhitespace(e)})==0},clearSelectedArr:function(e){var t;while(t=e.pop())v.removeAttributes(t,["class"])},scrollToView:function(e,t,n){var r=function(){var e=t.document,n=e.compatMode=="CSS1Compat";return{width:(n?e.documentElement.clientWidth:e.body.clientWidth)||0,height:(n?e.documentElement.clientHeight:e.body.clientHeight)||0}},i=function(e){if("pageXOffset"in e)return{x:e.pageXOffset||0,y:e.pageYOffset||0};var t=e.document;return{x:t.documentElement.scrollLeft||t.body.scrollLeft||0,y:t.documentElement.scrollTop||t.body.scrollTop||0}},s=r().height,o=s*-1+n;o+=e.offsetHeight||0;var u=v.getXY(e);o+=u.y;var a=i(t).y;(o>a||o<a-s)&&t.scrollTo(0,o+(o<0?-20:20))},isBr:function(e){return e.nodeType==1&&e.tagName=="BR"},isFillChar:function(e,t){if(e.nodeType!=3)return!1;var n=e.nodeValue;return t?(new RegExp("^"+v.fillChar)).test(n):!n.replace(new RegExp(v.fillChar,"g"),"").length},isStartInblock:function(e){var t=e.cloneRange(),n=0,r=t.startContainer,i;if(r.nodeType==1&&r.childNodes[t.startOffset]){r=r.childNodes[t.startOffset];var s=r.previousSibling;while(s&&v.isFillChar(s))r=s,s=s.previousSibling}this.isFillChar(r,!0)&&t.startOffset==1&&(t.setStartBefore(r),r=t.startContainer);while(r&&v.isFillChar(r))i=r,r=r.previousSibling;i&&(t.setStartBefore(i),r=t.startContainer),r.nodeType==1&&v.isEmptyNode(r)&&t.startOffset==1&&t.setStart(r,0).collapse(!0);while(!t.startOffset){r=t.startContainer;if(v.isBlockElm(r)||v.isBody(r)){n=1;break}var s=t.startContainer.previousSibling,o;if(!s)t.setStartBefore(t.startContainer);else{while(s&&v.isFillChar(s))o=s,s=s.previousSibling;o?t.setStartBefore(o):t.setStartBefore(t.startContainer)}}return n&&!v.isBody(t.startContainer)?1:0},isEmptyBlock:function(e,t){if(e.nodeType!=1)return 0;t=t||new RegExp("[  	\r\n"+v.fillChar+"]","g");if(e[n.ie?"innerText":"textContent"].replace(t,"").length>0)return 0;for(var r in c.$isNotEmpty)if(e.getElementsByTagName(r).length)return 0;return 1},setViewportOffset:function(e,t){var n=parseInt(e.style.left)|0,r=parseInt(e.style.top)|0,i=e.getBoundingClientRect(),s=t.left-i.left,o=t.top-i.top;s&&(e.style.left=n+s+"px"),o&&(e.style.top=r+o+"px")},fillNode:function(e,t){var r=n.ie?e.createTextNode(v.fillChar):e.createElement("br");t.innerHTML="",t.appendChild(r)},moveChild:function(e,t,n){while(e.firstChild)n&&t.firstChild?t.insertBefore(e.lastChild,t.firstChild):t.appendChild(e.firstChild)},hasNoAttributes:function(e){return n.ie?/^<\w+\s*?>/.test(e.outerHTML):e.attributes.length==0},isCustomeNode:function(e){return e.nodeType==1&&e.getAttribute("_ue_custom_node_")},isTagNode:function(e,t){return e.nodeType==1&&(new RegExp("\\b"+e.tagName+"\\b","i")).test(t)},filterNodeList:function(e,t,n){var r=[];if(!a.isFunction(t)){var i=t;t=function(e){return a.indexOf(a.isArray(i)?i:i.split(" "),e.tagName.toLowerCase())!=-1}}return a.each(e,function(e){t(e)&&r.push(e)}),r.length==0?null:r.length==1||!n?r[0]:r},isInNodeEndBoundary:function(e,t){var n=e.startContainer;if(n.nodeType==3&&e.startOffset!=n.nodeValue.length)return 0;if(n.nodeType==1&&e.startOffset!=n.childNodes.length)return 0;while(n!==t){if(n.nextSibling)return 0;n=n.parentNode}return 1},isBoundaryNode:function(e,t){var n;while(!v.isBody(e)){n=e,e=e.parentNode;if(n!==e[t])return!1}return!0},fillHtml:n.ie11below?"&nbsp;":"<br/>"},m=new RegExp(v.fillChar,"g");(function(){function s(e){e.collapsed=e.startContainer&&e.endContainer&&e.startContainer===e.endContainer&&e.startOffset==e.endOffset}function o(e){return!e.collapsed&&e.startContainer.nodeType==1&&e.startContainer===e.endContainer&&e.endOffset-e.startOffset==1}function u(e,t,n,r){return t.nodeType==1&&(c.$empty[t.tagName]||c.$nonChild[t.tagName])&&(n=v.getNodeIndex(t)+(e?0:1),t=t.parentNode),e?(r.startContainer=t,r.startOffset=n,r.endContainer||r.collapse(!0)):(r.endContainer=t,r.endOffset=n,r.startContainer||r.collapse(!1)),s(r),r}function f(e,t){var n=e.startContainer,r=e.endContainer,i=e.startOffset,s=e.endOffset,o=e.document,u=o.createDocumentFragment(),a,f;n.nodeType==1&&(n=n.childNodes[i]||(a=n.appendChild(o.createTextNode("")))),r.nodeType==1&&(r=r.childNodes[s]||(f=r.appendChild(o.createTextNode(""))));if(n===r&&n.nodeType==3)return u.appendChild(o.createTextNode(n.substringData(i,s-i))),t&&(n.deleteData(i,s-i),e.collapse(!0)),u;var l,c,h=u,p=v.findParents(n,!0),d=v.findParents(r,!0);for(var m=0;p[m]==d[m];)m++;for(var g=m,y;y=p[g];g++){l=y.nextSibling,y==n?a||(e.startContainer.nodeType==3?(h.appendChild(o.createTextNode(n.nodeValue.slice(i))),t&&n.deleteData(i,n.nodeValue.length-i)):h.appendChild(t?n:n.cloneNode(!0))):(c=y.cloneNode(!1),h.appendChild(c));while(l){if(l===r||l===d[g])break;y=l.nextSibling,h.appendChild(t?l:l.cloneNode(!0)),l=y}h=c}h=u,p[m]||(h.appendChild(p[m-1].cloneNode(!1)),h=h.firstChild);for(var g=m,b;b=d[g];g++){l=b.previousSibling,b==r?!f&&e.endContainer.nodeType==3&&(h.appendChild(o.createTextNode(r.substringData(0,s))),t&&r.deleteData(0,s)):(c=b.cloneNode(!1),h.appendChild(c));if(g!=m||!p[m])while(l){if(l===n)break;b=l.previousSibling,h.insertBefore(t?l:l.cloneNode(!0),h.firstChild),l=b}h=c}return t&&e.setStartBefore(d[m]?p[m]?d[m]:p[m-1]:d[m-1]).collapse(!0),a&&v.remove(a),f&&v.remove(f),u}function h(e,t){try{if(i&&v.inDoc(i,e))if(!i.nodeValue.replace(m,"").length){var r=i.parentNode;v.remove(i);while(r&&v.isEmptyInlineElement(r)&&(n.safari?!(v.getPosition(r,t)&v.POSITION_CONTAINS):!r.contains(t)))i=r.parentNode,v.remove(r),r=i}else i.nodeValue=i.nodeValue.replace(m,"")}catch(s){}}function p(e,t){var n;e=e[t];while(e&&v.isFillChar(e))n=e[t],v.remove(e),e=n}var e=0,r=v.fillChar,i,l=t.Range=function(e){var t=this;t.startContainer=t.startOffset=t.endContainer=t.endOffset=null,t.document=e,t.collapsed=!0};l.prototype={cloneContents:function(){return this.collapsed?null:f(this,0)},deleteContents:function(){var e;return this.collapsed||f(this,1),n.webkit&&(e=this.startContainer,e.nodeType==3&&!e.nodeValue.length&&(this.setStartBefore(e).collapse(!0),v.remove(e))),this},extractContents:function(){return this.collapsed?null:f(this,2)},setStart:function(e,t){return u(!0,e,t,this)},setEnd:function(e,t){return u(!1,e,t,this)},setStartAfter:function(e){return this.setStart(e.parentNode,v.getNodeIndex(e)+1)},setStartBefore:function(e){return this.setStart(e.parentNode,v.getNodeIndex(e))},setEndAfter:function(e){return this.setEnd(e.parentNode,v.getNodeIndex(e)+1)},setEndBefore:function(e){return this.setEnd(e.parentNode,v.getNodeIndex(e))},setStartAtFirst:function(e){return this.setStart(e,0)},setStartAtLast:function(e){return this.setStart(e,e.nodeType==3?e.nodeValue.length:e.childNodes.length)},setEndAtFirst:function(e){return this.setEnd(e,0)},setEndAtLast:function(e){return this.setEnd(e,e.nodeType==3?e.nodeValue.length:e.childNodes.length)},selectNode:function(e){return this.setStartBefore(e).setEndAfter(e)},selectNodeContents:function(e){return this.setStart(e,0).setEndAtLast(e)},cloneRange:function(){var e=this;return(new l(e.document)).setStart(e.startContainer,e.startOffset).setEnd(e.endContainer,e.endOffset)},collapse:
function(e){var t=this;return e?(t.endContainer=t.startContainer,t.endOffset=t.startOffset):(t.startContainer=t.endContainer,t.startOffset=t.endOffset),t.collapsed=!0,t},shrinkBoundary:function(e){function i(e){return e.nodeType==1&&!v.isBookmarkNode(e)&&!c.$empty[e.tagName]&&!c.$nonChild[e.tagName]}var t=this,n,r=t.collapsed;while(t.startContainer.nodeType==1&&(n=t.startContainer.childNodes[t.startOffset])&&i(n))t.setStart(n,0);if(r)return t.collapse(!0);if(!e)while(t.endContainer.nodeType==1&&t.endOffset>0&&(n=t.endContainer.childNodes[t.endOffset-1])&&i(n))t.setEnd(n,n.childNodes.length);return t},getCommonAncestor:function(e,t){var n=this,r=n.startContainer,i=n.endContainer;if(r===i){if(e&&o(this)){r=r.childNodes[n.startOffset];if(r.nodeType==1)return r}return t&&r.nodeType==3?r.parentNode:r}return v.getCommonAncestor(r,i)},trimBoundary:function(e){this.txtToElmBoundary();var t=this.startContainer,n=this.startOffset,r=this.collapsed,i=this.endContainer;if(t.nodeType==3){if(n==0)this.setStartBefore(t);else if(n>=t.nodeValue.length)this.setStartAfter(t);else{var s=v.split(t,n);t===i?this.setEnd(s,this.endOffset-n):t.parentNode===i&&(this.endOffset+=1),this.setStartBefore(s)}if(r)return this.collapse(!0)}return e||(n=this.endOffset,i=this.endContainer,i.nodeType==3&&(n==0?this.setEndBefore(i):(n<i.nodeValue.length&&v.split(i,n),this.setEndAfter(i)))),this},txtToElmBoundary:function(e){function t(e,t){var n=e[t+"Container"],r=e[t+"Offset"];n.nodeType==3&&(r?r>=n.nodeValue.length&&e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"After"](n):e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"Before"](n))}if(e||!this.collapsed)t(this,"start"),t(this,"end");return this},insertNode:function(e){var t=e,n=1;e.nodeType==11&&(t=e.firstChild,n=e.childNodes.length),this.trimBoundary(!0);var r=this.startContainer,i=this.startOffset,s=r.childNodes[i];return s?r.insertBefore(e,s):r.appendChild(e),t.parentNode===this.endContainer&&(this.endOffset=this.endOffset+n),this.setStartBefore(t)},setCursor:function(e,t){return this.collapse(!e).select(t)},createBookmark:function(t,n){var r,i=this.document.createElement("span");return i.style.cssText="display:none;line-height:0px;",i.appendChild(this.document.createTextNode("‍")),i.id="_baidu_bookmark_start_"+(n?"":e++),this.collapsed||(r=i.cloneNode(!0),r.id="_baidu_bookmark_end_"+(n?"":e++)),this.insertNode(i),r&&this.collapse().insertNode(r).setEndBefore(r),this.setStartAfter(i),{start:t?i.id:i,end:r?t?r.id:r:null,id:t}},moveToBookmark:function(e){var t=e.id?this.document.getElementById(e.start):e.start,n=e.end&&e.id?this.document.getElementById(e.end):e.end;return this.setStartBefore(t),v.remove(t),n?(this.setEndBefore(n),v.remove(n)):this.collapse(!0),this},enlarge:function(e,t){var n=v.isBody,r,i,s=this.document.createTextNode("");if(e){i=this.startContainer,i.nodeType==1?i.childNodes[this.startOffset]?r=i=i.childNodes[this.startOffset]:(i.appendChild(s),r=i=s):r=i;for(;;){if(v.isBlockElm(i)){i=r;while((r=i.previousSibling)&&!v.isBlockElm(r))i=r;this.setStartBefore(i);break}r=i,i=i.parentNode}i=this.endContainer,i.nodeType==1?((r=i.childNodes[this.endOffset])?i.insertBefore(s,r):i.appendChild(s),r=i=s):r=i;for(;;){if(v.isBlockElm(i)){i=r;while((r=i.nextSibling)&&!v.isBlockElm(r))i=r;this.setEndAfter(i);break}r=i,i=i.parentNode}s.parentNode===this.endContainer&&this.endOffset--,v.remove(s)}if(!this.collapsed){while(this.startOffset==0){if(t&&t(this.startContainer))break;if(n(this.startContainer))break;this.setStartBefore(this.startContainer)}while(this.endOffset==(this.endContainer.nodeType==1?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)){if(t&&t(this.endContainer))break;if(n(this.endContainer))break;this.setEndAfter(this.endContainer)}}return this},enlargeToBlockElm:function(e){while(!v.isBlockElm(this.startContainer))this.setStartBefore(this.startContainer);if(!e)while(!v.isBlockElm(this.endContainer))this.setEndAfter(this.endContainer);return this},adjustmentBoundary:function(){if(!this.collapsed){while(!v.isBody(this.startContainer)&&this.startOffset==this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length&&this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length)this.setStartAfter(this.startContainer);while(!v.isBody(this.endContainer)&&!this.endOffset&&this.endContainer[this.endContainer.nodeType==3?"nodeValue":"childNodes"].length)this.setEndBefore(this.endContainer)}return this},applyInlineStyle:function(e,t,n){if(this.collapsed)return this;this.trimBoundary().enlarge(!1,function(e){return e.nodeType==1&&v.isBlockElm(e)}).adjustmentBoundary();var r=this.createBookmark(),i=r.end,s=function(e){return e.nodeType==1?e.tagName.toLowerCase()!="br":!v.isWhitespace(e)},o=v.getNextDomNode(r.start,!1,s),u,a,f=this.cloneRange();while(o&&v.getPosition(o,i)&v.POSITION_PRECEDING)if(o.nodeType==3||c[e][o.tagName]){f.setStartBefore(o),u=o;while(u&&(u.nodeType==3||c[e][u.tagName])&&u!==i)a=u,u=v.getNextDomNode(u,u.nodeType==1,null,function(t){return c[e][t.tagName]});var l=f.setEndAfter(a).extractContents(),h;if(n&&n.length>0){var p,d;d=p=n[0].cloneNode(!1);for(var m=1,g;g=n[m++];)p.appendChild(g.cloneNode(!1)),p=p.firstChild;h=p}else h=f.document.createElement(e);t&&v.setAttributes(h,t),h.appendChild(l),f.insertNode(n?d:h);var y;e=="span"&&t.style&&/text\-decoration/.test(t.style)&&(y=v.findParentByTagName(h,"a",!0))?(v.setAttributes(y,t),v.remove(h,!0),h=y):(v.mergeSibling(h),v.clearEmptySibling(h)),v.mergeChild(h,t),o=v.getNextDomNode(h,!1,s),v.mergeToParent(h);if(u===i)break}else o=v.getNextDomNode(o,!0,s);return this.moveToBookmark(r)},removeInlineStyle:function(e){if(this.collapsed)return this;e=a.isArray(e)?e:[e],this.shrinkBoundary().adjustmentBoundary();var t=this.startContainer,n=this.endContainer;for(;;){if(t.nodeType==1){if(a.indexOf(e,t.tagName.toLowerCase())>-1)break;if(t.tagName.toLowerCase()=="body"){t=null;break}}t=t.parentNode}for(;;){if(n.nodeType==1){if(a.indexOf(e,n.tagName.toLowerCase())>-1)break;if(n.tagName.toLowerCase()=="body"){n=null;break}}n=n.parentNode}var r=this.createBookmark(),i,s;t&&(s=this.cloneRange().setEndBefore(r.start).setStartBefore(t),i=s.extractContents(),s.insertNode(i),v.clearEmptySibling(t,!0),t.parentNode.insertBefore(r.start,t)),n&&(s=this.cloneRange().setStartAfter(r.end).setEndAfter(n),i=s.extractContents(),s.insertNode(i),v.clearEmptySibling(n,!1,!0),n.parentNode.insertBefore(r.end,n.nextSibling));var o=v.getNextDomNode(r.start,!1,function(e){return e.nodeType==1}),u;while(o&&o!==r.end)u=v.getNextDomNode(o,!0,function(e){return e.nodeType==1}),a.indexOf(e,o.tagName.toLowerCase())>-1&&v.remove(o,!0),o=u;return this.moveToBookmark(r)},getClosedNode:function(){var e;if(!this.collapsed){var t=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(o(t)){var n=t.startContainer.childNodes[t.startOffset];n&&n.nodeType==1&&(c.$empty[n.tagName]||c.$nonChild[n.tagName])&&(e=n)}}return e},select:n.ie?function(e,t){var n;this.collapsed||this.shrinkBoundary();var s=this.getClosedNode();if(s&&!t){try{n=this.document.body.createControlRange(),n.addElement(s),n.select()}catch(o){}return this}var u=this.createBookmark(),a=u.start,f;n=this.document.body.createTextRange(),n.moveToElementText(a),n.moveStart("character",1);if(!this.collapsed){var l=this.document.body.createTextRange();f=u.end,l.moveToElementText(f),n.setEndPoint("EndToEnd",l)}else if(!e&&this.startContainer.nodeType!=3){var c=this.document.createTextNode(r),d=this.document.createElement("span");d.appendChild(this.document.createTextNode(r)),a.parentNode.insertBefore(d,a),a.parentNode.insertBefore(c,a),h(this.document,c),i=c,p(d,"previousSibling"),p(a,"nextSibling"),n.moveStart("character",-1),n.collapse(!0)}this.moveToBookmark(u),d&&v.remove(d);try{n.select()}catch(o){}return this}:function(e){function t(e){function t(t,n,r){t.nodeType==3&&t.nodeValue.length<n&&(e[r+"Offset"]=t.nodeValue.length)}t(e.startContainer,e.startOffset,"start"),t(e.endContainer,e.endOffset,"end")}var s=v.getWindow(this.document),o=s.getSelection(),u;n.gecko?this.document.body.focus():s.focus();if(o){o.removeAllRanges();if(this.collapsed&&!e){var a=this.startContainer,f=a;a.nodeType==1&&(f=a.childNodes[this.startOffset]),(a.nodeType!=3||!this.startOffset)&&(f?!f.previousSibling||f.previousSibling.nodeType!=3:!a.lastChild||a.lastChild.nodeType!=3)&&(u=this.document.createTextNode(r),this.insertNode(u),h(this.document,u),p(u,"previousSibling"),p(u,"nextSibling"),i=u,this.setStart(u,n.webkit?1:0).collapse(!0))}var l=this.document.createRange();if(this.collapsed&&n.opera&&this.startContainer.nodeType==1){var f=this.startContainer.childNodes[this.startOffset];if(!f)f=this.startContainer.lastChild,f&&v.isBr(f)&&this.setStartBefore(f).collapse(!0);else{while(f&&v.isBlockElm(f)){if(f.nodeType!=1||!f.childNodes[0])break;f=f.childNodes[0]}f&&this.setStartBefore(f).collapse(!0)}}t(this),l.setStart(this.startContainer,this.startOffset),l.setEnd(this.endContainer,this.endOffset),o.addRange(l)}return this},scrollToView:function(e,t){e=e?window:v.getWindow(this.document);var n=this,r=n.document.createElement("span");return r.innerHTML="&nbsp;",n.cloneRange().insertNode(r),v.scrollToView(r,e,t),v.remove(r),n},inFillChar:function(){var e=this.startContainer;return this.collapsed&&e.nodeType==3&&e.nodeValue.replace(new RegExp("^"+v.fillChar),"").length+1==e.nodeValue.length?!0:!1},createAddress:function(e,t){function i(e){var n=e?r.startContainer:r.endContainer,i=v.findParents(n,!0,function(e){return!v.isBody(e)}),s=[];for(var o=0,u;u=i[o++];)s.push(v.getNodeIndex(u,t));var a=0;if(t)if(n.nodeType==3){var f=n.previousSibling;while(f&&f.nodeType==3)a+=f.nodeValue.replace(m,"").length,f=f.previousSibling;a+=e?r.startOffset:r.endOffset}else{n=n.childNodes[e?r.startOffset:r.endOffset];if(n)a=v.getNodeIndex(n,t);else{n=e?r.startContainer:r.endContainer;var l=n.firstChild;while(l){if(v.isFillChar(l)){l=l.nextSibling;continue}a++;if(l.nodeType==3)while(l&&l.nodeType==3)l=l.nextSibling;else l=l.nextSibling}}}else a=e?v.isFillChar(n)?0:r.startOffset:r.endOffset;return a<0&&(a=0),s.push(a),s}var n={},r=this;return n.startAddress=i(!0),e||(n.endAddress=r.collapsed?[].concat(n.startAddress):i()),n},moveToAddress:function(e,t){function r(e,t){var r=n.document.body,i,s;for(var o=0,u,a=e.length;o<a;o++){u=e[o],i=r,r=r.childNodes[u];if(!r){s=u;break}}t?r?n.setStartBefore(r):n.setStart(i,s):r?n.setEndBefore(r):n.setEnd(i,s)}var n=this;return r(e.startAddress,!0),!t&&e.endAddress&&r(e.endAddress),n},equals:function(e){for(var t in this)if(this.hasOwnProperty(t)&&this[t]!==e[t])return!1;return!0},traversal:function(e,t){if(this.collapsed)return this;var n=this.createBookmark(),r=n.end,i=v.getNextDomNode(n.start,!1,t);while(i&&i!==r&&v.getPosition(i,r)&v.POSITION_PRECEDING){var s=v.getNextDomNode(i,!1,t);e(i),i=s}return this.moveToBookmark(n)}}})(),function(){function r(e,t){var n=v.getNodeIndex;e=e.duplicate(),e.collapse(t);var r=e.parentElement();if(!r.hasChildNodes())return{container:r,offset:0};var i=r.children,s,o=e.duplicate(),u=0,a=i.length-1,f=-1,l;while(u<=a){f=Math.floor((u+a)/2),s=i[f],o.moveToElementText(s);var h=o.compareEndPoints("StartToStart",e);if(h>0)a=f-1;else{if(!(h<0))return{container:r,offset:n(s)};u=f+1}}if(f==-1){o.moveToElementText(r),o.setEndPoint("StartToStart",e),l=o.text.replace(/(\r\n|\r)/g,"\n").length,i=r.childNodes;if(!l)return s=i[i.length-1],{container:s,offset:s.nodeValue.length};var p=i.length;while(l>0)l-=i[--p].nodeValue.length;return{container:i[p],offset:-l}}o.collapse(h>0),o.setEndPoint(h>0?"StartToStart":"EndToStart",e),l=o.text.replace(/(\r\n|\r)/g,"\n").length;if(!l)return c.$empty[s.tagName]||c.$nonChild[s.tagName]?{container:r,offset:n(s)+(h>0?0:1)}:{container:s,offset:h>0?0:s.childNodes.length};while(l>0)try{var d=s;s=s[h>0?"previousSibling":"nextSibling"],l-=s.nodeValue.length}catch(m){return{container:r,offset:n(d)}}return{container:s,offset:h>0?-l:s.nodeValue.length+l}}function i(e,t){if(e.item)t.selectNode(e.item(0));else{var n=r(e,!0);t.setStart(n.container,n.offset),e.compareEndPoints("StartToEnd",e)!=0&&(n=r(e,!1),t.setEnd(n.container,n.offset))}return t}function s(e){var t;try{t=e.getNative().createRange()}catch(n){return null}var r=t.item?t.item(0):t.parentElement();return(r.ownerDocument||r)===e.document?t:null}var o=t.Selection=function(e){var t=this,r;t.document=e,n.ie9below&&(r=v.getWindow(e).frameElement,v.on(r,"beforedeactivate",function(){t._bakIERange=t.getIERange()}),v.on(r,"activate",function(){try{!s(t)&&t._bakIERange&&t._bakIERange.select()}catch(e){}t._bakIERange=null})),r=e=null};o.prototype={rangeInBody:function(e,t){var r=n.ie9below||t?e.item?e.item():e.parentElement():e.startContainer;return r===this.document.body||v.inDoc(r,this.document)},getNative:function(){var e=this.document;try{return e?n.ie9below?e.selection:v.getWindow(e).getSelection():null}catch(t){return null}},getIERange:function(){var e=s(this);return!e&&this._bakIERange?this._bakIERange:e},cache:function(){this.clear(),this._cachedRange=this.getRange(),this._cachedStartElement=this.getStart(),this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var e=this.getStart();return e?v.findParents(e,!0,null,!0):[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){try{if(n.ie9below){var e=s(this);return!!e&&!!this.rangeInBody(e)}return!!this.getNative().rangeCount}catch(t){return!1}},getRange:function(){function r(e){var n=t.document.body.firstChild,r=e.collapsed;while(n&&n.firstChild)e.setStart(n,0),n=n.firstChild;e.startContainer||e.setStart(t.document.body,0),r&&e.collapse(!0)}var t=this;if(t._cachedRange!=null)return this._cachedRange;var s=new e.editor.dom.Range(t.document);if(n.ie9below){var o=t.getIERange();if(o)try{i(o,s)}catch(u){r(s)}else r(s)}else{var a=t.getNative();if(a&&a.rangeCount){var f=a.getRangeAt(0),l=a.getRangeAt(a.rangeCount-1);s.setStart(f.startContainer,f.startOffset).setEnd(l.endContainer,l.endOffset),s.collapsed&&v.isBody(s.startContainer)&&!s.startOffset&&r(s)}else{if(this._bakRange&&v.inDoc(this._bakRange.startContainer,this.document))return this._bakRange;r(s)}}return this._bakRange=s},getStart:function(){if(this._cachedStartElement)return this._cachedStartElement;var e=n.ie9below?this.getIERange():this.getRange(),t,r,i,s;if(n.ie9below){if(!e)return this.document.body.firstChild;if(e.item)return e.item(0);t=e.duplicate(),t.text.length>0&&t.moveStart("character",1),t.collapse(1),r=t.parentElement(),s=i=e.parentElement();while(i=i.parentNode)if(i==r){r=s;break}}else{e.shrinkBoundary(),r=e.startContainer,r.nodeType==1&&r.hasChildNodes()&&(r=r.childNodes[Math.min(r.childNodes.length-1,e.startOffset)]);if(r.nodeType==3)return r.parentNode}return r},getText:function(){var e,t;return this.isFocus()&&(e=this.getNative())?(t=n.ie9below?e.createRange():e.getRangeAt(0),n.ie9below?t.text:t.toString()):""},clearRange:function(){this.getNative()[n.ie9below?"empty":"removeAllRanges"]()}}}(),function(){function s(e,t){var n;if(t.textarea)if(a.isString(t.textarea)){for(var r=0,i,s=v.getElementsByTagName(e,"textarea");i=s[r++];)if(i.id=="ueditor_textarea_"+t.options.textarea){n=i;break}}else n=t.textarea;n||(e.appendChild(n=v.createElement(document,"textarea",{name:t.options.textarea,id:"ueditor_textarea_"+t.options.textarea,style:"display:none"})),t.textarea=n),!n.getAttribute("name")&&n.setAttribute("name",t.options.textarea),n.value=t.hasContents()?t.options.allHtmlEnabled?t.getAllHtml():t.getContent(null,null,!0):""}function o(e){for(var t in UE.plugins)UE.plugins[t].call(e)}function u(e){for(var t in e)return t}function l(e){e.langIsReady=!0,e.fireEvent("langReady")}var e=0,i,h=UE.Editor=function(t){var n=this;n.uid=e++,f.call(n),n.commands={},n.options=a.extend(a.clone(t||{}),UEDITOR_CONFIG,!0),n.shortcutkeys={},n.inputRules=[],n.outputRules=[],n.setOpt(h.defaultOptions(n)),a.isEmptyObject(UE.I18N)?a.loadFile(document,{src:n.options.langPath+n.options.lang+"/"+n.options.lang+".js",tag:"script",type:"text/javascript",defer:"defer"},function(){UE.plugin.load(n),l(n)}):(n.options.lang=u(UE.I18N),UE.plugin.load(n),l(n)),UE.instants["ueditorInstant"+n.uid]=n};h.prototype={registerCommand:function(e,t){this.commands[e]=t},ready:function(e){var t=this;e&&(t.isReady?e.apply(t):t.addListener("ready",e))},setOpt:function(e,t){var n={};a.isString(e)?n[e]=t:n=e,a.extend(this.options,n,!0)},getOpt:function(e){return this.options[e]},destroy:function(){var e=this;e.fireEvent("destroy");var t=e.container.parentNode,n=e.textarea;n?n.style.display="":(n=document.createElement("textarea"),t.parentNode.insertBefore(n,t)),n.style.width=e.iframe.offsetWidth+"px",n.style.height=e.iframe.offsetHeight+"px",n.value=e.getContent(),n.id=e.key,t.innerHTML="",v.remove(t);var r=e.key;for(var i in e)e.hasOwnProperty(i)&&delete this[i];UE.delEditor(r)},render:function(e){var t=this,i=t.options,s=function(t){return parseInt(v.getComputedStyle(e,t))};a.isString(e)&&(e=document.getElementById(e));if(e){i.initialFrameWidth?i.minFrameWidth=i.initialFrameWidth:i.minFrameWidth=i.initialFrameWidth=e.offsetWidth,i.initialFrameHeight?i.minFrameHeight=i.initialFrameHeight:i.initialFrameHeight=i.minFrameHeight=e.offsetHeight,e.style.width=/%$/.test(i.initialFrameWidth)?"100%":i.initialFrameWidth-s("padding-left")-s("padding-right")+"px",e.style.height=/%$/.test(i.initialFrameHeight)?"100%":i.initialFrameHeight-s("padding-top")-s("padding-bottom")+"px",e.style.zIndex=i.zIndex;var o=(r&&n.version<9?"":"<!DOCTYPE html>")+"<html xmlns='http://www.w3.org/1999/xhtml' class='view' ><head>"+"<style type='text/css'>"+".view{padding:0;word-wrap:break-word;cursor:text;height:90%;}\n"+"body{margin:8px;font-family:sans-serif;font-size:16px;}"+"p{margin:5px 0;}</style>"+(i.iframeCssUrl?"<link rel='stylesheet' type='text/css' href='"+a.unhtml(i.iframeCssUrl)+"'/>":"")+(i.initialStyle?"<style>"+i.initialStyle+"</style>":"")+"</head><body class='view' ></body>"+"<script type='text/javascript' "+(r?"defer='defer'":"")+" id='_initialScript'>"+"setTimeout(function(){editor = window.parent.UE.instants['ueditorInstant"+t.uid+"'];editor._setup(document);},0);"+"var _tmpScript = document.getElementById('_initialScript');_tmpScript.parentNode.removeChild(_tmpScript);</script></html>";e.appendChild(v.createElement(document,"iframe",{id:"ueditor_"+t.uid,width:"100%",height:"100%",frameborder:"0",src:"javascript:void(function(){document.open();"+(i.customDomain&&document.domain!=location.hostname?'document.domain="'+document.domain+'";':"")+'document.write("'+o+'");document.close();}())'})),e.style.overflow="hidden",setTimeout(function(){/%$/.test(i.initialFrameWidth)&&(i.minFrameWidth=i.initialFrameWidth=e.offsetWidth),/%$/.test(i.initialFrameHeight)&&(i.minFrameHeight=i.initialFrameHeight=e.offsetHeight,e.style.height=i.initialFrameHeight+"px")})}},_setup:function(e){var i=this,o=i.options;r?(e.body.disabled=!0,e.body.contentEditable=!0,e.body.disabled=!1):e.body.contentEditable=!0,e.body.spellcheck=!1,i.document=e,i.window=e.defaultView||e.parentWindow,i.iframe=i.window.frameElement,i.body=e.body,i.selection=new t.Selection(e);var u;n.gecko&&(u=this.selection.getNative())&&u.removeAllRanges(),this._initEvents();for(var a=this.iframe.parentNode;!v.isBody(a);a=a.parentNode)if(a.tagName=="FORM"){i.form=a,i.options.autoSyncData?v.on(i.window,"blur",function(){s(a,i)}):v.on(a,"submit",function(){s(this,i)});break}if(o.initialContent)if(o.autoClearinitialContent){var f=i.execCommand;i.execCommand=function(){return i.fireEvent("firstBeforeExecCommand"),f.apply(i,arguments)},this._setDefaultContent(o.initialContent)}else this.setContent(o.initialContent,!1,!0);v.isEmptyNode(i.body)&&(i.body.innerHTML="<p>"+(n.ie?"":"<br/>")+"</p>"),o.focus&&setTimeout(function(){i.focus(i.options.focusInEnd),!i.options.autoClearinitialContent&&i._selectionChange()},0),i.container||(i.container=this.iframe.parentNode);try{i.document.execCommand("2D-position",!1,!1)}catch(l){}try{i.document.execCommand("enableInlineTableEditing",!1,!1)}catch(l){}try{i.document.execCommand("enableObjectResizing",!1,!1)}catch(l){}i._bindshortcutKeys(),i.isReady=1,i.fireEvent("ready"),o.onready&&o.onready.call(i),n.ie9below||v.on(i.window,["blur","focus"],function(e){if(e.type=="blur"){i._bakRange=i.selection.getRange();try{i._bakNativeRange=i.selection.getNative().getRangeAt(0),i.selection.getNative().removeAllRanges()}catch(e){i._bakNativeRange=null}}else try{i._bakRange&&i._bakRange.select()}catch(e){}}),n.gecko&&n.version<=10902&&(i.body.contentEditable=!1,setTimeout(function(){i.body.contentEditable=!0},100),setInterval(function(){i.body.style.height=i.iframe.offsetHeight-20+"px"},100)),!o.isShow&&i.setHide(),o.readonly&&i.setDisabled()},sync:function(e){var t=this,n=e?document.getElementById(e):v.findParent(t.iframe.parentNode,function(e){return e.tagName=="FORM"},!0);n&&s(n,t)},setHeight:function(e,t){e!==parseInt(this.iframe.parentNode.style.height)&&(this.iframe.parentNode.style.height=e+"px"),!t&&(this.options.minFrameHeight=this.options.initialFrameHeight=e),this.body.style.height=e+"px",!t&&this.trigger("setHeight")},addshortcutkey:function(e,t){var n={};t?n[e]=t:n=e,a.extend(this.shortcutkeys,n)},_bindshortcutKeys:function(){var e=this,t=this.shortcutkeys;e.addListener("keydown",function(n,r){var i=r.keyCode||r.which;for(var s in t){var o=t[s].split(",");for(var u=0,a;a=o[u++];){a=a.split(":");var f=a[0],l=a[1];if(/^(ctrl)(\+shift)?\+(\d+)$/.test(f.toLowerCase())||/^(\d+)$/.test(f))if((RegExp.$1=="ctrl"?r.ctrlKey||r.metaKey:0)&&(RegExp.$2!=""?r[RegExp.$2.slice(1)+"Key"]:1)&&i==RegExp.$3||i==RegExp.$1)e.queryCommandState(s,l)!=-1&&e.execCommand(s,l),v.preventDefault(r)}}})},getContent:function(e,t,n,r,i){var s=this;e&&a.isFunction(e)&&(t=e,e="");if(t?!t():!this.hasContents())return"";s.fireEvent("beforegetcontent");var o=s.body.innerHTML;o=o.replace(/style="text-align: (.+?);"/gi,'be-class="$1"'),o=o.replace(/style="text-decoration: underline;"/gi,'be-class="underline"');var u=UE.htmlparser(o,r);s.options.filterRules&&UE.filterNode(u,s.options.filterRules),s.filterOutputRule(u),s.fireEvent("aftergetcontent",e,u);var o=u.toHtml(i);return o=o.replace(/[\n\r]/g,""),o=o.replace(/[^(be\-class="center"\>)](<img.*?\/?>)/gi,'</p><p be-class="center">$1</p><p>'),o=o.replace(/<p>(<br\/?>|&nbsp;)<\/p>/gi,""),o=o.replace(/<br\/?>/gi,"</p><p>"),o=o.replace(/<p><\/p>/g,""),o=o.replace(new RegExp(v.fillChar,"g"),""),o=o.replace(/\u00a0/g,""),o=o.replace(/&nbsp;/g,""),o},getAllHtml:function(){var e=this,t=[],i="";e.fireEvent("getAllHtml",t);if(n.ie&&n.version>8){var s="";a.each(e.document.styleSheets,function(e){s+=e.href?'<link rel="stylesheet" type="text/css" href="'+e.href+'" />':"<style>"+e.cssText+"</style>"}),a.each(e.document.getElementsByTagName("script"),function(e){s+=e.outerHTML})}return"<html><head>"+(e.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+e.options.charset+'"/>':"")+(s||e.document.getElementsByTagName("head")[0].innerHTML)+t.join("\n")+"</head>"+"<body "+(r&&n.version<9?'class="view"':"")+">"+e.getContent(null,null,!0)+"</body></html>"},getPlainTxt:function(){var e=new RegExp(v.fillChar,"g"),t=this.body.innerHTML.replace(/[\n\r]/g,"");return t=t.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(e,t,n){return c.$block[n]?"\n":t?t:""}),t.replace(e,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getContentTxt:function(){var e=new RegExp(v.fillChar,"g");return this.body[n.ie?"innerText":"textContent"].replace(e,"").replace(/\u00a0/g," ")},setContent:function(e,t,r){function u(e){return e.tagName=="DIV"&&e.getAttribute("cdata_tag")}var i=this;i.fireEvent("beforesetcontent",e);var o=UE.htmlparser(e);i.filterInputRule(o),e=o.toHtml(),i.body.innerHTML=(t?i.body.innerHTML:"")+e;if(i.options.enterTag=="p"){var a=this.body.firstChild,f;if(!a||a.nodeType==1&&(c.$cdata[a.tagName]||u(a)||v.isCustomeNode(a))&&a===this.body.lastChild)this.body.innerHTML="<p>"+(n.ie?"&nbsp;":"<br/>")+"</p>"+this.body.innerHTML;else{var l=i.document.createElement("p");while(a){while(a&&(a.nodeType==3||a.nodeType==1&&c.p[a.tagName]&&!c.$cdata[a.tagName]))f=a.nextSibling,l.appendChild(a),a=f;if(l.firstChild){if(!a){i.body.appendChild(l);break}a.parentNode.insertBefore(l,a),l=i.document.createElement("p")}a=a.nextSibling}}}i.fireEvent("aftersetcontent"),i.fireEvent("contentchange"),!r&&i._selectionChange(),i._bakRange=i._bakIERange=i._bakNativeRange=null;var h;n.gecko&&(h=this.selection.getNative())&&h.removeAllRanges(),i.options.autoSyncData&&i.form&&s(i.form,i)},focus:function(e){try{var t=this,n=t.selection.getRange();if(e){var r=t.body.lastChild;r&&r.nodeType==1&&!c.$empty[r.tagName]&&(v.isEmptyBlock(r)?n.setStartAtFirst(r):n.setStartAtLast(r),n.collapse(!0)),n.setCursor(!0)}else{if(!n.collapsed&&v.isBody(n.startContainer)&&n.startOffset==0){var r=t.body.firstChild;r&&r.nodeType==1&&!c.$empty[r.tagName]&&n.setStartAtFirst(r).collapse(!0)}n.select(!0)}this.fireEvent("focus selectionchange")}catch(i){}},isFocus:function(){return this.selection.isFocus()},blur:function(){var e=this.selection.getNative();if(e.empty&&n.ie){var t=document.body.createTextRange();t.moveToElementText(document.body),t.collapse(!0),t.select(),e.empty()}else e.removeAllRanges()},_initEvents:function(){var e=this,t=e.document,r=e.window;e._proxyDomEvent=a.bind(e._proxyDomEvent,e),v.on(t,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],e._proxyDomEvent),v.on(r,["focus","blur"],e._proxyDomEvent),v.on(e.body,"drop",function(t){n.gecko&&t.stopPropagation&&t.stopPropagation(),e.fireEvent("contentchange")}),v.on(t,["mouseup","keydown"],function(t){if(t.type=="keydown"&&(t.ctrlKey||t.metaKey||t.shiftKey||t.altKey))return;if(t.button==2)return;e._selectionChange(250,t)})},_proxyDomEvent:function(e){return this.fireEvent("before"+e.type.replace(/^on/,"").toLowerCase())===!1?!1:this.fireEvent(e.type.replace(/^on/,""),e)===!1?!1:this.fireEvent("after"+e.type.replace(/^on/,"").toLowerCase())},_selectionChange:function(e,t){var r=this,s=!1,o,u;if(n.ie&&n.version<9&&t&&t.type=="mouseup"){var a=this.selection.getRange();a.collapsed||(s=!0,o=t.clientX,u=t.clientY)}clearTimeout(i),i=setTimeout(function(){if(!r.selection||!r.selection.getNative())return;var e;if(s&&r.selection.getNative().type=="None"){e=r.document.body.createTextRange();try{e.moveToPoint(o,u)}catch(n){e=null}}var i;e&&(i=r.selection.getIERange,r.selection.getIERange=function(){return e}),r.selection.cache(),i&&(r.selection.getIERange=i),r.selection._cachedRange&&r.selection._cachedStartElement&&(r.fireEvent("beforeselectionchange"),r.fireEvent("selectionchange",!!t),r.fireEvent("afterselectionchange"),r.selection.clear())},e||50)},_callCmdFn:function(e,t){var n=t[0].toLowerCase(),r,i;r=this.commands[n]||UE.commands[n],i=r&&r[e];if((!r||!i)&&e=="queryCommandState")return 0;if(i)return i.apply(this,t)},execCommand:function(e){e=e.toLowerCase();var t=this,n,r=t.commands[e]||UE.commands[e];return!r||!r.execCommand?null:(!r.notNeedUndo&&!t.__hasEnterExecCommand?(t.__hasEnterExecCommand=!0,t.queryCommandState.apply(t,arguments)!=-1&&(t.fireEvent("saveScene"),t.fireEvent.apply(t,["beforeexeccommand",e].concat(arguments)),n=this._callCmdFn("execCommand",arguments),t.fireEvent.apply(t,["afterexeccommand",e].concat(arguments)),t.fireEvent("saveScene")),t.__hasEnterExecCommand=!1):(n=this._callCmdFn("execCommand",arguments),!t.__hasEnterExecCommand&&!r.ignoreContentChange&&!t._ignoreContentChange&&t.fireEvent("contentchange")),!t.__hasEnterExecCommand&&!r.ignoreContentChange&&!t._ignoreContentChange&&t._selectionChange(),n)},queryCommandState:function(e){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(e){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(e){if(e)for(var t=0,n;n=e[t++];)if(this.document.getElementsByTagName(n).length>0)return!0;if(!v.isEmptyBlock(this.body))return!0;e=["div"];for(t=0;n=e[t++];){var r=v.getElementsByTagName(this.document,n);for(var i=0,s;s=r[i++];)if(v.isCustomeNode(s))return!0}return!1},reset:function(){this.fireEvent("reset")},setEnabled:function(){var e=this,t;if(e.body.contentEditable=="false"){e.body.contentEditable=!0,t=e.selection.getRange();try{t.moveToBookmark(e.lastBk),delete e.lastBk}catch(n){t.setStartAtFirst(e.body).collapse(!0)}t.select(!0),e.bkqueryCommandState&&(e.queryCommandState=e.bkqueryCommandState,delete e.bkqueryCommandState),e.bkqueryCommandValue&&(e.queryCommandValue=e.bkqueryCommandValue,delete e.bkqueryCommandValue),e.fireEvent("selectionchange")}},enable:function(){return this.setEnabled()},setDisabled:function(e){var t=this;e=e?a.isArray(e)?e:[e]:[],t.body.contentEditable=="true"&&(t.lastBk||(t.lastBk=t.selection.getRange().createBookmark(!0)),t.body.contentEditable=!1,t.bkqueryCommandState=t.queryCommandState,t.bkqueryCommandValue=t.queryCommandValue,t.queryCommandState=function(n){return a.indexOf(e,n)!=-1?t.bkqueryCommandState.apply(t,arguments):-1},t.queryCommandValue=function(n){return a.indexOf(e,n)!=-1?t.bkqueryCommandValue.apply(t,arguments):null},t.fireEvent("selectionchange"))},disable:function(e){return this.setDisabled(e)},_setDefaultContent:function(){function e(){var t=this;t.document.getElementById("initContent")&&(t.body.innerHTML="<p>"+(r?"":"<br/>")+"</p>",t.removeListener("firstBeforeExecCommand focus",e),setTimeout(function(){t.focus(),t._selectionChange()},0))}return function(t){var n=this;n.body.innerHTML='<p id="initContent">'+t+"</p>",n.addListener("firstBeforeExecCommand focus",e)}}(),setShow:function(){var e=this,t=e.selection.getRange();if(e.container.style.display=="none"){try{t.moveToBookmark(e.lastBk),delete e.lastBk}catch(n){t.setStartAtFirst(e.body).collapse(!0)}setTimeout(function(){t.select(!0)},100),e.container.style.display=""}},show:function(){return this.setShow()},setHide:function(){var e=this;e.lastBk||(e.lastBk=e.selection.getRange().createBookmark(!0)),e.container.style.display="none"},hide:function(){return this.setHide()},getLang:function(e){var t=UE.I18N[this.options.lang];if(!t)throw Error("not import language file");e=(e||"").split(".");for(var n=0,r;r=e[n++];){t=t[r];if(!t)break}return t},getContentLength:function(e,t){var n=this.getContent(!1,!1,!0).length;if(e){t=(t||[]).concat(["hr","img","iframe"]),n=this.getContentTxt().replace(/[\t\r\n]+/g,"").length;for(var r=0,i;i=t[r++];)n+=this.document.getElementsByTagName(i).length}return n},addInputRule:function(e){this.inputRules.push(e)},filterInputRule:function(e){for(var t=0,n;n=this.inputRules[t++];)n.call(this,e)},addOutputRule:function(e){this.outputRules.push(e)},filterOutputRule:function(e){for(var t=0,n;n=this.outputRules[t++];)n.call(this,e)},getActionUrl:function(e){var t=this.getOpt(e)||e,n=this.getOpt("imageUrl"),r=this.getOpt("serverUrl");return!r&&n&&(r=n.replace(/^(.*[\/]).+([\.].+)$/,"$1controller$2")),r?(r=r+(r.indexOf("?")==-1?"?":"&")+"action="+(t||""),a.formatUrl(r)):""}},a.inherits(h,f)}(),UE.Editor.defaultOptions=function(e){var t=e.options.UEDITOR_HOME_URL;return{isShow:!0,initialContent:"",initialStyle:"",autoClearinitialContent:!1,iframeCssUrl:t+"themes/iframe.css",textarea:"editorValue",focus:!1,focusInEnd:!0,autoClearEmptyNode:!0,fullscreen:!1,readonly:!1,zIndex:999,imagePopup:!0,enterTag:"p",customDomain:!1,lang:"zh-cn",langPath:t+"lang/",theme:"default",themePath:t+"themes/",allHtmlEnabled:!1,scaleEnabled:!1,tableNativeEditInFF:!1,autoSyncData:!0,fileNameFormat:"{time}{rand:6}"}};var g=UE.filterWord=function(){function e(e){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<(v|o):|lang=)/ig.test(e)}function t(e){return e=e.replace(/[\d.]+\w+/g,function(e){return a.transUnitToPx(e)}),e}function r(e){return e.replace(/[\t\r\n]+/g," ").replace(/<!--[\s\S]*?-->/ig,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(e){if(n.opera)return"";try{if(/Bitmap/i.test(e))return"";var r=e.match(/width:([ \d.]*p[tx])/i)[1],i=e.match(/height:([ \d.]*p[tx])/i)[1],s=e.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+t(r)+'" height="'+t(i)+'" src="'+s+'" />'}catch(o){return""}}).replace(/<\/?div[^>]*>/g,"").replace(/v:\w+=(["']?)[^'"]+\1/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)([\w-]+)\2/ig,function(e,t,n,r){return t=="class"&&r=="MsoListParagraph"?
e:""}).replace(/<(font|span)[^>]*>(\s*)<\/\1>/gi,function(e,t,n){return n.replace(/[\t\r\n ]+/g," ")}).replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(e,n,r,i){var s=[],o=i.replace(/^\s+|\s+$/,"").replace(/&#39;/g,"'").replace(/&quot;/gi,"'").replace(/[\d.]+(cm|pt)/g,function(e){return a.transUnitToPx(e)}).split(/;\s*/g);for(var u=0,f;f=o[u];u++){var l,c,h=f.split(":");if(h.length==2){l=h[0].toLowerCase(),c=h[1].toLowerCase();if(/^(background)\w*/.test(l)&&c.replace(/(initial|\s)/g,"").length==0||/^(margin)\w*/.test(l)&&/^0\w+$/.test(c))continue;switch(l){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":/<table/.test(n)||(s[u]=l.replace(/^mso-|-alt$/g,"")+":"+t(c));continue;case"horiz-align":s[u]="text-align:"+c;continue;case"vert-align":s[u]="vertical-align:"+c;continue;case"font-color":case"mso-foreground":s[u]="color:"+c;continue;case"mso-background":case"mso-highlight":s[u]="background:"+c;continue;case"mso-default-height":s[u]="min-height:"+t(c);continue;case"mso-default-width":s[u]="min-width:"+t(c);continue;case"mso-padding-between-alt":s[u]="border-collapse:separate;border-spacing:"+t(c);continue;case"text-line-through":if(c=="single"||c=="double")s[u]="text-decoration:line-through";continue;case"mso-zero-height":c=="yes"&&(s[u]="display:none");continue;case"margin":if(!/[1-9]/.test(c))continue}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(l)||/text\-indent|padding|margin/.test(l)&&/\-[\d.]+/.test(c))continue;s[u]=l+":"+h[1]}}return n+(s.length?' style="'+s.join(";").replace(/;{2,}/g,";")+'"':"")})}return function(t){return e(t)?r(t):t}}();(function(){function s(e,t,n){return e.push(i),t+(n?1:-1)}function o(e,t){for(var n=0;n<t;n++)e.push(r)}function u(e,t,n,r){switch(e.type){case"root":for(var i=0,a;a=e.children[i++];)n&&a.type=="element"&&!c.$inlineWithA[a.tagName]&&i>1&&(s(t,r,!0),o(t,r)),u(a,t,n,r);break;case"text":f(e,t);break;case"element":l(e,t,n,r);break;case"comment":h(e,t,n)}return t}function f(e,t){e.parentNode.tagName=="pre"?t.push(e.data):t.push(n[e.parentNode.tagName]?a.html(e.data):e.data.replace(/[ ]{2}/g," &nbsp;"))}function l(e,n,r,i){var f="";if(e.attrs){f=[];var l=e.attrs;for(var h in l)f.push(h+(l[h]!==undefined?'="'+(t[h]?a.html(l[h]).replace(/["]/g,function(e){return"&quot;"}):a.unhtml(l[h]))+'"':""));f=f.join(" ")}n.push("<"+e.tagName+(f?" "+f:"")+(c.$empty[e.tagName]?"/":"")+">"),r&&!c.$inlineWithA[e.tagName]&&e.tagName!="pre"&&e.children&&e.children.length&&(i=s(n,i,!0),o(n,i));if(e.children&&e.children.length)for(var p=0,d;d=e.children[p++];)r&&d.type=="element"&&!c.$inlineWithA[d.tagName]&&p>1&&(s(n,i),o(n,i)),u(d,n,r,i);c.$empty[e.tagName]||(r&&!c.$inlineWithA[e.tagName]&&e.tagName!="pre"&&e.children&&e.children.length&&(i=s(n,i),o(n,i)),n.push("</"+e.tagName+">"))}function h(e,t){t.push("<!--"+e.data+"-->")}function p(e,t){var n;if(e.type=="element"&&e.getAttr("id")==t)return e;if(e.children&&e.children.length)for(var r=0,i;i=e.children[r++];)if(n=p(i,t))return n}function d(e,t,n){e.type=="element"&&e.tagName==t&&n.push(e);if(e.children&&e.children.length)for(var r=0,i;i=e.children[r++];)d(i,t,n)}function v(e,t){if(e.children&&e.children.length)for(var n=0,r;r=e.children[n];)v(r,t),r.parentNode&&(r.children&&r.children.length&&t(r),r.parentNode&&n++);else t(e)}var e=UE.uNode=function(e){this.type=e.type,this.data=e.data,this.tagName=e.tagName,this.parentNode=e.parentNode,this.attrs=e.attrs||{},this.children=e.children},t={href:1,src:1,_src:1,_href:1,cdata_data:1},n={style:1,script:1},r="    ",i="\n";e.createElement=function(t){return/[<>]/.test(t)?UE.htmlparser(t).children[0]:new e({type:"element",children:[],tagName:t})},e.createText=function(e,t){return new UE.uNode({type:"text",data:t?e:a.unhtml(e||"")})},e.prototype={toHtml:function(e){var t=[];return u(this,t,e,0),t.join("")},innerHTML:function(e){if(this.type!="element"||c.$empty[this.tagName])return this;if(a.isString(e)){if(this.children)for(var t=0,n;n=this.children[t++];)n.parentNode=null;this.children=[];var r=UE.htmlparser(e);for(var t=0,n;n=r.children[t++];)this.children.push(n),n.parentNode=this;return this}var r=new UE.uNode({type:"root",children:this.children});return r.toHtml()},innerText:function(t,n){if(this.type!="element"||c.$empty[this.tagName])return this;if(t){if(this.children)for(var r=0,i;i=this.children[r++];)i.parentNode=null;return this.children=[],this.appendChild(e.createText(t,n)),this}return this.toHtml().replace(/<[^>]+>/g,"")},getData:function(){return this.type=="element"?"":this.data},firstChild:function(){return this.children?this.children[0]:null},lastChild:function(){return this.children?this.children[this.children.length-1]:null},previousSibling:function(){var e=this.parentNode;for(var t=0,n;n=e.children[t];t++)if(n===this)return t==0?null:e.children[t-1]},nextSibling:function(){var e=this.parentNode;for(var t=0,n;n=e.children[t++];)if(n===this)return e.children[t]},replaceChild:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var n=0,r;r=this.children[n];n++)if(r===t)return this.children.splice(n,1,e),t.parentNode=null,e.parentNode=this,e}},appendChild:function(e){if(this.type=="root"||this.type=="element"&&!c.$empty[this.tagName]){this.children||(this.children=[]),e.parentNode&&e.parentNode.removeChild(e);for(var t=0,n;n=this.children[t];t++)if(n===e){this.children.splice(t,1);break}return this.children.push(e),e.parentNode=this,e}},insertBefore:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var n=0,r;r=this.children[n];n++)if(r===t)return this.children.splice(n,0,e),e.parentNode=this,e}},insertAfter:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var n=0,r;r=this.children[n];n++)if(r===t)return this.children.splice(n+1,0,e),e.parentNode=this,e}},removeChild:function(e,t){if(this.children)for(var n=0,r;r=this.children[n];n++)if(r===e){this.children.splice(n,1),r.parentNode=null;if(t&&r.children&&r.children.length)for(var i=0,s;s=r.children[i];i++)this.children.splice(n+i,0,s),s.parentNode=this;return r}},getAttr:function(e){return this.attrs&&this.attrs[e.toLowerCase()]},setAttr:function(e,t){if(!e){delete this.attrs;return}this.attrs||(this.attrs={});if(a.isObject(e))for(var n in e)e[n]?this.attrs[n.toLowerCase()]=e[n]:delete this.attrs[n];else t?this.attrs[e.toLowerCase()]=t:delete this.attrs[e]},getIndex:function(){var e=this.parentNode;for(var t=0,n;n=e.children[t];t++)if(n===this)return t;return-1},getNodeById:function(e){var t;if(this.children&&this.children.length)for(var n=0,r;r=this.children[n++];)if(t=p(r,e))return t},getNodesByTagName:function(e){e=a.trim(e).replace(/[ ]{2,}/g," ").split(" ");var t=[],n=this;return a.each(e,function(e){if(n.children&&n.children.length)for(var r=0,i;i=n.children[r++];)d(i,e,t)}),t},getStyle:function(e){var t=this.getAttr("style");if(!t)return"";var n=new RegExp("(^|;)\\s*"+e+":([^;]+)","i"),r=t.match(n);return r&&r[0]?r[2]:""},setStyle:function(e,t){function n(e,t){var n=new RegExp("(^|;)\\s*"+e+":([^;]+;?)","gi");r=r.replace(n,"$1"),t&&(r=e+":"+a.unhtml(t)+";"+r)}var r=this.getAttr("style");r||(r="");if(a.isObject(e))for(var i in e)n(i,e[i]);else n(e,t);this.setAttr("style",a.trim(r))},traversal:function(e){return this.children&&this.children.length&&v(this,e),this}}})();var y=UE.htmlparser=function(e,t){function l(e,t){if(f[e.tagName]){var n=o.createElement(f[e.tagName]);e.appendChild(n),n.appendChild(o.createText(t)),e=n}else e.appendChild(o.createText(t))}function h(e,t,n){var i;if(i=u[t]){var f=e,l;while(f.type!="root"){if(a.isArray(i)?a.indexOf(i,f.tagName)!=-1:i==f.tagName){e=f,l=!0;break}f=f.parentNode}l||(e=h(e,a.isArray(i)?i[0]:i))}var p=new o({parentNode:e,type:"element",tagName:t.toLowerCase(),children:c.$empty[t]?null:[]});if(n){var d={},v;while(v=r.exec(n))d[v[1].toLowerCase()]=s[v[1].toLowerCase()]?v[2]||v[3]||v[4]:a.unhtml(v[2]||v[3]||v[4]);p.attrs=d}return e.children.push(p),c.$empty[t]?e:p}function p(e,t){e.children.push(new o({type:"comment",data:t,parentNode:e}))}var n=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/<>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,r=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,i={b:1,code:1,i:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,span:1,sub:1,img:1,sup:1,font:1,big:1,small:1,iframe:1,a:1,br:1,pre:1};e=e.replace(new RegExp(v.fillChar,"g"),""),t||(e=e.replace(new RegExp("[\\r\\t\\n"+(t?"":" ")+"]*</?(\\w+)\\s*(?:[^>]*)>[\\r\\t\\n"+(t?"":" ")+"]*","g"),function(e,n){return n&&i[n.toLowerCase()]?e.replace(/(^[\n\r]+)|([\n\r]+$)/g,""):e.replace(new RegExp("^[\\r\\n"+(t?"":" ")+"]+"),"").replace(new RegExp("[\\r\\n"+(t?"":" ")+"]+$"),"")}));var s={href:1,src:1},o=UE.uNode,u={td:"tr",tr:["tbody","thead","tfoot"],tbody:"table",th:"tr",thead:"table",tfoot:"table",caption:"table",li:["ul","ol"],dt:"dl",dd:"dl",option:"select"},f={ol:"li",ul:"li"},d,m=0,g=0,y=new o({type:"root",children:[]}),b=y;while(d=n.exec(e)){m=d.index;try{m>g&&l(b,e.slice(g,m));if(d[3])c.$cdata[b.tagName]?l(b,d[0]):b=h(b,d[3].toLowerCase(),d[4]);else if(d[1]){if(b.type!="root")if(c.$cdata[b.tagName]&&!c.$cdata[d[1]])l(b,d[0]);else{var w=b;while(b.type=="element"&&b.tagName!=d[1].toLowerCase()){b=b.parentNode;if(b.type=="root")throw b=w,"break"}b=b.parentNode}}else d[2]&&p(b,d[2])}catch(E){}g=n.lastIndex}return g<e.length&&l(b,e.slice(g)),y},b=UE.filterNode=function(){function e(t,n){switch(t.type){case"text":break;case"element":var r;if(r=n[t.tagName])if(r==="-")t.parentNode.removeChild(t);else if(a.isFunction(r)){var i=t.parentNode,s=t.getIndex();r(t);if(t.parentNode){if(t.children)for(var o=0,u;u=t.children[o];)e(u,n),u.parentNode&&o++}else for(var o=s,u;u=i.children[o];)e(u,n),u.parentNode&&o++}else{var f=r.$;if(f&&t.attrs){var l={},h;for(var p in f){h=t.getAttr(p);if(p=="style"&&a.isArray(f[p])){var d=[];a.each(f[p],function(e){var n;(n=t.getStyle(e))&&d.push(e+":"+n)}),h=d.join(";")}h&&(l[p]=h)}t.attrs=l}if(t.children)for(var o=0,u;u=t.children[o];)e(u,n),u.parentNode&&o++}else if(c.$cdata[t.tagName])t.parentNode.removeChild(t);else{var i=t.parentNode,s=t.getIndex();t.parentNode.removeChild(t,!0);for(var o=s,u;u=i.children[o];)e(u,n),u.parentNode&&o++}break;case"comment":t.parentNode.removeChild(t)}}return function(t,n){if(a.isEmptyObject(n))return t;var r;(r=n["-"])&&a.each(r.split(" "),function(e){n[e]="-"});for(var i=0,s;s=t.children[i];)e(s,n),s.parentNode&&i++;return t}}();UE.plugin=function(){var e={};return{register:function(t,n,r,i){r&&a.isFunction(r)&&(i=r,r=null),e[t]={optionName:r||t,execFn:n,afterDisabled:i}},load:function(t){a.each(e,function(e){var n=e.execFn.call(t);t.options[e.optionName]!==!1?n&&a.each(n,function(e,n){switch(n.toLowerCase()){case"shortcutkey":t.addshortcutkey(e);break;case"bindevents":a.each(e,function(e,n){t.addListener(n,e)});break;case"bindmultievents":a.each(a.isArray(e)?e:[e],function(e){var n=a.trim(e.type).split(/\s+/);a.each(n,function(n){t.addListener(n,e.handler)})});break;case"commands":a.each(e,function(e,n){t.commands[n]=e});break;case"outputrule":t.addOutputRule(e);break;case"inputrule":t.addInputRule(e);break;case"defaultoptions":t.setOpt(e)}}):e.afterDisabled&&e.afterDisabled.call(t)}),a.each(UE.plugins,function(e){e.call(t)})},run:function(t,n){var r=e[t];r&&r.exeFn.call(n)}}}();var w=UE.keymap={Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Alt:18,CapsLock:20,Esc:27,Spacebar:32,PageUp:33,PageDown:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Insert:45,Del:46,NumLock:144,Cmd:91,"=":187,"-":189,b:66,i:73,z:90,y:89,v:86,x:88,s:83,n:78};UE.plugins.defaultfilter=function(){function t(t){var r;a.each(t.getNodesByTagName("article aside blockquote details dl div footer header nav section h1 h2 h3 h4 h5 h6 ul ol li"),function(e){e.tagName="p"}),a.each(t.getNodesByTagName("a abbr address bdi bdo big center cite code del dt dd font ins mark s small sub sup u"),function(e){e.tagName="span"});var i=UE.uNode.createElement("p"),s=t.firstChild();while(s)if(s.tagName=="p")i.children.length&&(t.insertBefore(i,s),i=UE.uNode.createElement("p")),s=s.nextSibling();else{var o=s.nextSibling();i.appendChild(s),s=o}i.children.length&&t.appendChild(i),t.traversal(function(t){if(t.type=="element"){if(!c.$cdata[t.tagName]&&e.options.autoClearEmptyNode&&c.$inline[t.tagName]&&!c.$empty[t.tagName]&&!t.attrs|a.isEmptyObject(t.attrs)){t.firstChild()?t.tagName=="span"&&(!t.attrs||a.isEmptyObject(t.attrs))&&t.parentNode.removeChild(t,!0):t.parentNode.removeChild(t);return}switch(t.tagName){case"img":if(r=t.getAttr("src"))if(/^data:/.test(r)){t.parentNode.removeChild(t);break}break;case"span":n.webkit&&(r=t.getStyle("white-space"))&&/nowrap|normal/.test(r)&&(t.setStyle("white-space",""),e.options.autoClearEmptyNode&&a.isEmptyObject(t.attrs)&&t.parentNode.removeChild(t,!0)),r=t.getAttr("id"),r&&/^_baidu_bookmark_/i.test(r)&&t.parentNode.removeChild(t);break;case"p":if(r=t.getAttr("align"))t.setAttr("be-class",r),t.setAttr("align");a.each(t.children,function(e){if(e.type=="element"&&e.tagName=="p"){var n=e.nextSibling();t.parentNode.insertAfter(e,t);var r=e;while(n){var i=n.nextSibling();t.parentNode.insertAfter(n,r),r=n,n=i}return!1}}),t.firstChild()||t.parentNode.removeChild(t)}}})}var e=this;e.addInputRule(t),e.addOutputRule(t)},UE.commands.inserthtml={execCommand:function(e,t,r){var i=this,s,o;if(!t)return;if(i.fireEvent("beforeinserthtml",t)===!0)return;s=i.selection.getRange(),o=s.document.createElement("div"),o.style.display="inline";if(!r){var u=UE.htmlparser(t);i.options.filterRules&&UE.filterNode(u,i.options.filterRules),i.filterInputRule(u),t=u.toHtml()}o.innerHTML=a.trim(t);if(!s.collapsed){var f=s.startContainer;v.isFillChar(f)&&s.setStartBefore(f),f=s.endContainer,v.isFillChar(f)&&s.setEndAfter(f),s.txtToElmBoundary(),s.endContainer&&s.endContainer.nodeType==1&&(f=s.endContainer.childNodes[s.endOffset],f&&v.isBr(f)&&s.setEndAfter(f)),s.startOffset==0&&(f=s.startContainer,v.isBoundaryNode(f,"firstChild")&&(f=s.endContainer,s.endOffset==(f.nodeType==3?f.nodeValue.length:f.childNodes.length)&&v.isBoundaryNode(f,"lastChild")&&(i.body.innerHTML="<p>"+(n.ie?"":"<br/>")+"</p>",s.setStart(i.body.firstChild,0).collapse(!0)))),!s.collapsed&&s.deleteContents();if(s.startContainer.nodeType==1){var l=s.startContainer.childNodes[s.startOffset],h;if(l&&v.isBlockElm(l)&&(h=l.previousSibling)&&v.isBlockElm(h)){s.setEnd(h,h.childNodes.length).collapse();while(l.firstChild)h.appendChild(l.firstChild);v.remove(l)}}}var l,p,h,d,g=0,y;s.inFillChar()&&(l=s.startContainer,v.isFillChar(l)?(s.setStartBefore(l).collapse(!0),v.remove(l)):v.isFillChar(l,!0)&&(l.nodeValue=l.nodeValue.replace(m,""),s.startOffset--,s.collapsed&&s.collapse(!0)));var b=v.findParentByTagName(s.startContainer,"li",!0);if(b){var w,E;while(l=o.firstChild){while(l&&(l.nodeType==3||!v.isBlockElm(l)||l.tagName=="HR"))w=l.nextSibling,s.insertNode(l).collapse(),E=l,l=w;if(l)if(/^(ol|ul)$/i.test(l.tagName)){while(l.firstChild)E=l.firstChild,v.insertAfter(b,l.firstChild),b=b.nextSibling;v.remove(l)}else{var S;w=l.nextSibling,S=i.document.createElement("li"),v.insertAfter(b,S),S.appendChild(l),E=l,l=w,b=S}}b=v.findParentByTagName(s.startContainer,"li",!0),v.isEmptyBlock(b)&&v.remove(b),E&&s.setStartAfter(E).collapse(!0).select(!0)}else{while(l=o.firstChild){if(g){var x=i.document.createElement("p");while(l&&(l.nodeType==3||!c.$block[l.tagName]))y=l.nextSibling,x.appendChild(l),l=y;x.firstChild&&(l=x)}s.insertNode(l),y=l.nextSibling;if(!g&&l.nodeType==v.NODE_ELEMENT&&v.isBlockElm(l)){p=v.findParent(l,function(e){return v.isBlockElm(e)});if(p&&p.tagName.toLowerCase()!="body"&&(!c[p.tagName][l.nodeName]||l.parentNode!==p)){if(!c[p.tagName][l.nodeName])h=p;else{d=l.parentNode;while(d!==p)h=d,d=d.parentNode}v.breakParent(l,h||d);var h=l.previousSibling;v.trimWhiteTextNode(h),h.childNodes.length||v.remove(h),!n.ie&&(w=l.nextSibling)&&v.isBlockElm(w)&&w.lastChild&&!v.isBr(w.lastChild)&&w.appendChild(i.document.createElement("br")),g=1}}var w=l.nextSibling;if(!o.firstChild&&w&&v.isBlockElm(w)){s.setStart(w,0).collapse(!0);break}s.setEndAfter(l).collapse()}l=s.startContainer,y&&v.isBr(y)&&v.remove(y);if(v.isBlockElm(l)&&v.isEmptyNode(l))if(y=l.nextSibling)v.remove(l),y.nodeType==1&&c.$block[y.tagName]&&s.setStart(y,0).collapse(!0).shrinkBoundary();else try{l.innerHTML=n.ie?v.fillChar:"<br/>"}catch(T){s.setStartBefore(l),v.remove(l)}try{s.select(!0)}catch(T){}}setTimeout(function(){s=i.selection.getRange(),s.scrollToView(i.autoHeightEnabled,i.autoHeightEnabled?v.getXY(i.iframe).y:0),i.fireEvent("afterinserthtml",t)},200)}},UE.plugins.justify=function(){var e=this,t=v.isBlockElm,n={left:1,right:1,center:1,justify:1},r=function(e,n){var r=e.createBookmark(),i=function(e){return e.nodeType==1?e.tagName.toLowerCase()!="br"&&!v.isBookmarkNode(e):!v.isWhitespace(e)};e.enlarge(!0);var s=e.createBookmark(),o=v.getNextDomNode(s.start,!1,i),u=e.cloneRange(),f;while(o&&!(v.getPosition(o,s.end)&v.POSITION_FOLLOWING))if(o.nodeType==3||!t(o)){u.setStartBefore(o);while(o&&o!==s.end&&!t(o))f=o,o=v.getNextDomNode(o,!1,null,function(e){return!t(e)});u.setEndAfter(f);var l=u.getCommonAncestor();if(!v.isBody(l)&&t(l))v.setStyles(l,a.isString(n)?{"text-align":n}:n),o=l;else{var c=e.document.createElement("p");v.setStyles(c,a.isString(n)?{"text-align":n}:n);var h=u.extractContents();c.appendChild(h),u.insertNode(c),o=c}o=v.getNextDomNode(o,!1,i)}else o=v.getNextDomNode(o,!0,i);return e.moveToBookmark(s).moveToBookmark(r)};UE.commands.justify={execCommand:function(e,t){var n=this.selection.getRange(),i;return n.collapsed&&(i=this.document.createTextNode("p"),n.insertNode(i)),r(n,t),i&&(n.setStartBefore(i).collapse(!0),v.remove(i)),n.select(),!0},queryCommandValue:function(){var e=this.selection.getStart(),t=v.getComputedStyle(e,"text-align");return n[t]?t:"left"},queryCommandState:function(){var e=this.selection.getStart(),t=e&&v.findParentByTagName(e,["td","th","caption"],!0);return t?-1:0}}},UE.plugins.font=function(){function s(e){var t;while(t=e.parentNode){if(t.tagName!="SPAN"||v.getChildCount(t,function(e){return!v.isBookmarkNode(e)&&!v.isBr(e)})!=1)break;t.style.cssText+=e.style.cssText,v.remove(e,!0),e=t}}function o(e,t,n){if(i[t]){e.adjustmentBoundary();if(!e.collapsed&&e.startContainer.nodeType==1){var r=e.startContainer.childNodes[e.startOffset];if(r&&v.isTagNode(r,"span")){var s=e.createBookmark();a.each(v.getElementsByTagName(r,"span"),function(e){if(!e.parentNode||v.isBookmarkNode(e))return;if(t=="backcolor"&&v.getComputedStyle(e,"background-color").toLowerCase()===n)return;v.removeStyle(e,i[t]),e.style.cssText.replace(/^\s+$/,"").length==0&&v.remove(e,!0)}),e.moveToBookmark(s)}}}}function f(e,t,r){var i=e.collapsed,u=e.createBookmark(),f;if(i){f=u.start.parentNode;while(c.$inline[f.tagName])f=f.parentNode}else f=v.getCommonAncestor(u.start,u.end);a.each(v.getElementsByTagName(f,"span"),function(e){if(!e.parentNode||v.isBookmarkNode(e))return;if(/\s*border\s*:\s*none;?\s*/i.test(e.style.cssText)){/^\s*border\s*:\s*none;?\s*$/.test(e.style.cssText)?v.remove(e,!0):v.removeStyle(e,"border");return}/border/i.test(e.style.cssText)&&e.parentNode.tagName=="SPAN"&&/border/i.test(e.parentNode.style.cssText)&&(e.style.cssText=e.style.cssText.replace(/border[^:]*:[^;]+;?/gi,""));if(t!="fontborder"||r!="none"){var i=e.nextSibling;while(i&&i.nodeType==1&&i.tagName=="SPAN"){if(v.isBookmarkNode(i)&&t=="fontborder"){e.appendChild(i),i=e.nextSibling;continue}i.style.cssText==e.style.cssText&&(v.moveChild(i,e),v.remove(i));if(e.nextSibling===i)break;i=e.nextSibling}}s(e);if(n.ie&&n.version>8){var o=v.findParent(e,function(e){return e.tagName=="SPAN"&&/background-color/.test(e.style.cssText)});o&&!/background-color/.test(e.style.cssText)&&(e.style.backgroundColor=o.style.backgroundColor)}}),e.moveToBookmark(u),o(e,t,r)}var e=this,t={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",strikethrough:"text-decoration",fontborder:"border"},r={underline:1,strikethrough:1,fontborder:1},i={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family"};e.setOpt({fontfamily:[{name:"songti",val:"宋体,SimSun"},{name:"yahei",val:"微软雅黑,Microsoft YaHei"},{name:"kaiti",val:"楷体,楷体_GB2312, SimKai"},{name:"heiti",val:"黑体, SimHei"},{name:"lishu",val:"隶书, SimLi"},{name:"andaleMono",val:"andale mono"},{name:"arial",val:"arial, helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"comicSansMs",val:"comic sans ms"},{name:"impact",val:"impact,chicago"},{name:"timesNewRoman",val:"times new roman"}],fontsize:[10,11,12,14,16,18,20,24,36]}),e.addInputRule(function(e){a.each(e.getNodesByTagName("u s del font strike"),function(e){if(e.tagName=="font"){var t=[];for(var n in e.attrs)switch(n){case"size":t.push("font-size:"+({1:"10",2:"12",3:"16",4:"18",5:"24",6:"32",7:"48"}[e.attrs[n]]||e.attrs[n])+"px");break;case"color":t.push("color:"+e.attrs[n]);break;case"face":t.push("font-family:"+e.attrs[n]);break;case"style":t.push(e.attrs[n])}e.attrs={style:t.join(";")}}else{var r=e.tagName=="u"?"underline":"line-through";e.attrs={style:(e.getAttr("style")||"")+"text-decoration:"+r+";"}}e.tagName="span"})});for(var l in t)(function(e,t){UE.commands[e]={execCommand:function(i,s){s=s||(this.queryCommandState(i)?"none":i=="underline"?"underline":i=="fontborder"?"1px solid #000":"line-through");var o=this,a=this.selection.getRange(),l;if(s=="default")a.collapsed&&(l=o.document.createTextNode("font"),a.insertNode(l).select()),o.execCommand("removeFormat","span,a",t),l&&(a.setStartBefore(l).collapse(!0),v.remove(l)),f(a,i,s),a.select();else if(!a.collapsed)r[e]&&o.queryCommandValue(e)&&o.execCommand("removeFormat","span,a",t),a=o.selection.getRange(),a.applyInlineStyle("span",{style:t+":"+s}),f(a,i,s),a.select();else{var c=v.findParentByTagName(a.startContainer,"span",!0);l=o.document.createTextNode("font");if(c&&!c.children.length&&!c[n.ie?"innerText":"textContent"].replace(m,"").length)a.insertNode(l),r[e]&&(a.selectNode(l).select(),o.execCommand("removeFormat","span,a",t,null),c=v.findParentByTagName(l,"span",!0),a.setStartBefore(l)),c&&(c.style.cssText+=";"+t+":"+s),a.collapse(!0).select();else{a.insertNode(l),a.selectNode(l).select(),c=a.document.createElement("span");if(r[e]){if(v.findParentByTagName(l,"a",!0)){a.setStartBefore(l).setCursor(),v.remove(l);return}o.execCommand("removeFormat","span,a",t)}c.style.cssText=t+":"+s,l.parentNode.insertBefore(c,l);if(!n.ie||n.ie&&n.version==9){var h=c.parentNode;while(!v.isBlockElm(h))h.tagName=="SPAN"&&(c.style.cssText=h.style.cssText+";"+c.style.cssText),h=h.parentNode}u?setTimeout(function(){a.setStart(c,0).collapse(!0),f(a,i,s),a.select()}):(a.setStart(c,0).collapse(!0),f(a,i,s),a.select())}v.remove(l)}return!0},queryCommandValue:function(e){var n=this.selection.getStart();if(e=="underline"||e=="strikethrough"){var r=n,i;while(r&&!v.isBlockElm(r)&&!v.isBody(r)){if(r.nodeType==1){i=v.getComputedStyle(r,t);if(i!="none")return i}r=r.parentNode}return"none"}if(e=="fontborder"){var s=n,o;while(s&&c.$inline[s.tagName]){if(o=v.getComputedStyle(s,"border"))if(/1px/.test(o)&&/solid/.test(o))return o;s=s.parentNode}return""}if(e=="FontSize"){var u=v.getComputedStyle(n,t),s=/^([\d\.]+)(\w+)$/.exec(u);return s?Math.floor(s[1])+s[2]:u}return v.getComputedStyle(n,t)},queryCommandState:function(e){if(!r[e])return 0;var t=this.queryCommandValue(e);return e=="fontborder"?/1px/.test(t)&&/solid/.test(t):e=="underline"?/underline/.test(t):/line\-through/.test(t)}}})(l,t[l])},UE.plugins.removeformat=function(){var e=this;e.setOpt({removeFormatTags:"b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var",removeFormatAttributes:"class,style,lang,width,height,align,hspace,valign"}),e.commands.removeformat={execCommand:function(e,r,i,s,o){function m(e){if(e.nodeType==3||e.tagName.toLowerCase()!="span")return 0;if(n.ie){var t=e.attributes;if(t.length){for(var r=0,i=t.length;r<i;r++)if(t[r].specified)return 0;return 1}}return!e.attributes.length}function g(e){var t=e.createBookmark();e.collapsed&&e.enlarge(!0);if(!o){var n=v.findParentByTagName(e.startContainer,"a",!0);n&&e.setStartBefore(n),n=v.findParentByTagName(e.endContainer,"a",!0),n&&e.setEndAfter(n)}l=e.createBookmark(),h=l.start;while((p=h.parentNode)&&!v.isBlockElm(p))v.breakParent(h,p),v.clearEmptySibling(h);if(l.end){h=l.end;while((p=h.parentNode)&&!v.isBlockElm(p))v.breakParent(h,p),v.clearEmptySibling(h);var r=v.getNextDomNode(l.start,!1,d),s;while(r){if(r==l.end)break;s=v.getNextDomNode(r,!0,d),!c.$empty[r.tagName.toLowerCase()]&&!v.isBookmarkNode(r)&&(u.test(r.tagName)?i?(v.removeStyle(r,i),m(r)&&i!="text-decoration"&&v.remove(r,!0)):v.remove(r,!0):!c.$tableContent[r.tagName]&&!c.$list[r.tagName]&&(v.removeAttributes(r,a),m(r)&&v.remove(r,!0))),r=s}}var f=l.start.parentNode;v.isBlockElm(f)&&!c.$tableContent[f.tagName]&&!c.$list[f.tagName]&&v.removeAttributes(f,a),f=l.end.parentNode,l.end&&v.isBlockElm(f)&&!c.$tableContent[f.tagName]&&!c.$list[f.tagName]&&v.removeAttributes(f,a),e.moveToBookmark(l).moveToBookmark(t);var h=e.startContainer,g,y=e.collapsed;while(h.nodeType==1&&v.isEmptyNode(h)&&c.$removeEmpty[h.tagName])g=h.parentNode,e.setStartBefore(h),e.startContainer===e.endContainer&&e.endOffset--,v.remove(h),h=g;if(!y){h=e.endContainer;while(h.nodeType==1&&v.isEmptyNode(h)&&c.$removeEmpty[h.tagName])g=h.parentNode,e.setEndBefore(h),v.remove(h),h=g}}var u=new RegExp("^(?:"+(r||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),a=i?[]:(s||this.options.removeFormatAttributes).split(","),f=new t.Range(this.document),l,h,p,d=function(e){return e.nodeType==1};f=this.selection.getRange(),g(f),f.select()}}},UE.commands.indent={execCommand:function(){var e=this,t=e.queryCommandState("indent")?"0em":e.options.indentValue||"2em";e.execCommand("Paragraph","p",{style:"text-indent:"+t})},queryCommandState:function(){var e=v.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return e&&e.style.textIndent&&parseInt(e.style.textIndent)?1:0}},UE.plugins.selectall=function(){var e=this;e.commands.selectall={execCommand:function(){var e=this,t=e.body,r=e.selection.getRange();r.selectNodeContents(t),v.isEmptyBlock(t)&&(n.opera&&t.firstChild&&t.firstChild.nodeType==1&&r.setStartAtFirst(t.firstChild),r.collapse(!0)),r.select(!0)},notNeedUndo:1},e.addshortcutkey({selectAll:"ctrl+65"})},UE.plugins.wordcount=function(){var e=this;e.setOpt("wordCount",!0),e.addListener("contentchange",function(){e.fireEvent("wordcount")});var t;e.addListener("ready",function(){var e=this;v.on(e.body,"keyup",function(n){var r=n.keyCode||n.which,i={16:1,18:1,20:1,37:1,38:1,39:1,40:1};if(r in i)return;clearTimeout(t),t=setTimeout(function(){e.fireEvent("wordcount")},200)})})},UE.plugins.dragdrop=function(){var e=this;e.ready(function(){v.on(this.body,"dragend",function(){var t=e.selection.getRange(),n=t.getClosedNode()||e.selection.getStart();if(n&&n.tagName=="IMG"){var r=n.previousSibling,i;while(i=n.nextSibling){if(i.nodeType!=1||i.tagName!="SPAN"||!!i.firstChild)break;v.remove(i)}(r&&r.nodeType==1&&!v.isEmptyBlock(r)||!r)&&(!i||i&&!v.isEmptyBlock(i))&&(r&&r.tagName=="P"&&!v.isEmptyBlock(r)?(r.appendChild(n),v.moveChild(i,r),v.remove(i)):i&&i.tagName=="P"&&!v.isEmptyBlock(i)&&i.insertBefore(n,i.firstChild),r&&r.tagName=="P"&&v.isEmptyBlock(r)&&v.remove(r),i&&i.tagName=="P"&&v.isEmptyBlock(i)&&v.remove(i),t.selectNode(n).select(),e.fireEvent("saveScene"))}})}),e.addListener("keyup",function(t,n){var r=n.keyCode||n.which;if(r==13){var i=e.selection.getRange(),s;(s=v.findParentByTagName(i.startContainer,"p",!0))&&v.getComputedStyle(s,"text-align")=="center"&&v.removeStyle(s,"text-align")}})},UE.plugins.undo=function(){function l(e,t){if(e.length!=t.length)return 0;for(var n=0,r=e.length;n<r;n++)if(e[n]!=t[n])return 0;return 1}function c(e,t){return e.collapsed!=t.collapsed?0:!l(e.startAddress,t.startAddress)||!l(e.endAddress,t.endAddress)?0:1}function h(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.undo=function(){if(this.hasUndo){if(!this.list[this.index-1]&&this.list.length==1){this.reset();return}while(this.list[this.index].content==this.list[this.index-1].content){this.index--;if(this.index==0)return this.restore(0)}this.restore(--this.index)}},this.redo=function(){if(this.hasRedo){while(this.list[this.index].content==this.list[this.index+1].content){this.index++;if(this.index==this.list.length-1)return this.restore(this.index)}this.restore(++this.index)}},this.restore=function(){var e=this.editor,r=this.list[this.index],i=UE.htmlparser(r.content.replace(o,""));e.options.autoClearEmptyNode=!1,e.filterInputRule(i),e.options.autoClearEmptyNode=f,e.document.body.innerHTML=i.toHtml(),e.fireEvent("afterscencerestore"),n.ie&&a.each(v.getElementsByTagName(e.document,"td th caption p"),function(t){v.isEmptyNode(t)&&v.fillNode(e.document,t)});try{var s=(new t.Range(e.document)).moveToAddress(r.address);s.select(u[s.startContainer.nodeName.toLowerCase()])}catch(l){}this.update(),this.clearKey(),e.fireEvent("reset",!0)},this.getScene=function(){var e=this.editor,t=e.selection.getRange(),n=t.createAddress(!1,!0);e.fireEvent("beforegetscene");var r=UE.htmlparser(e.body.innerHTML);e.options.autoClearEmptyNode=!1,e.filterOutputRule(r),e.options.autoClearEmptyNode=f;var i=r.toHtml();return e.fireEvent("aftergetscene"),{address:n,content:i}},this.save=function(t,n){clearTimeout(e);var s=this.getScene(n),o=this.list[this.index];o&&o.content!=s.content&&r.trigger("contentchange");if(o&&o.content==s.content&&(t?1:c(o.address,s.address)))return;this.list=this.list.slice(0,this.index+1),this.list.push(s),this.list.length>i&&this.list.shift(),this.index=this.list.length-1,this.clearKey(),this.update()},this.update=function(){this.hasRedo=!!this.list[this.index+1],this.hasUndo=!!this.list[this.index-1]},this.reset=function(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.clearKey()},this.clearKey=function(){m=0,g=null}}function p(){this.undoManger.save()}var e,r=this,i=r.options.maxUndoCount||20,s=r.options.maxInputCount||20,o=new RegExp(v.fillChar+"|</hr>","gi"),u={ol:1,ul:1,table:1,tbody:1,tr:1,body:1},f=r.options.autoClearEmptyNode;r.undoManger=new h,r.undoManger.editor=r,r.addListener("saveScene",function(){var e=Array.prototype.splice.call(arguments,1);this.undoManger.save.apply(this.undoManger,e)}),r.addListener("reset",function(e,t){t||this.undoManger.reset()}),r.commands.redo=r.commands.undo={execCommand:function(e){this.undoManger[e]()},queryCommandState:function(e){return this.undoManger["has"+(e.toLowerCase()=="undo"?"Undo":"Redo")]?0:-1},notNeedUndo:1};var d={16:1,17:1,18:1,37:1,38:1,39:1,40:1},m=0,g,y=!1;r.addListener("ready",function(){v.on(this.body,"compositionstart",function(){y=!0}),v.on(this.body,"compositionend",function(){y=!1})}),r.addshortcutkey({Undo:"ctrl+90",Redo:"ctrl+89"});var b=!0;r.addListener("keydown",function(t,n){var r=this,i=n.keyCode||n.which;if(!d[i]&&!n.ctrlKey&&!n.metaKey&&!n.shiftKey&&!n.altKey){if(y)return;if(!r.selection.getRange().collapsed){r.undoManger.save(!1,!0),b=!1;return}r.undoManger.list.length==0&&r.undoManger.save(!0),clearTimeout(e);function o(e){e.undoManger.save(!1,!0),e.fireEvent("selectionchange")}e=setTimeout(function(){if(y){var e=setInterval(function(){y||(o(r),clearInterval(e))},300);return}o(r)},200),g=i,m++,m>=s&&o(r)}}),r.addListener("keyup",function(e,t){var n=t.keyCode||t.which;if(!d[n]&&!t.ctrlKey&&!t.metaKey&&!t.shiftKey&&!t.altKey){if(y)return;b||(this.undoManger.save(!1,!0),b=!0)}}),r.stopCmdUndo=function(){r.__hasEnterExecCommand=!0},r.startCmdUndo=function(){r.__hasEnterExecCommand=!1}},UE.plugins.paste=function(){function e(e){var t=this.document;if(t.getElementById("baidu_pastebin"))return;var r=this.selection.getRange(),i=r.createBookmark(),s=t.createElement("div");s.id="baidu_pastebin",n.webkit&&s.appendChild(t.createTextNode(v.fillChar+v.fillChar)),t.body.appendChild(s),i.start.style.display="",s.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+v.getXY(i.start).y+"px",r.selectNodeContents(s).select(!0),setTimeout(function(){if(n.webkit)for(var o=0,u=t.querySelectorAll("#baidu_pastebin"),a;a=u[o++];){if(!v.isEmptyNode(a)){s=a;break}v.remove(a)}try{s.parentNode.removeChild(s)}catch(f){}r.moveToBookmark(i).select(!0),e(s)},0)}function r
(e){var r;if(e.firstChild){var i=v.getElementsByTagName(e,"span");for(var s=0,o;o=i[s++];)(o.id=="_baidu_cut_start"||o.id=="_baidu_cut_end")&&v.remove(o);if(n.webkit){var u=e.querySelectorAll("div br");for(var s=0,f;f=u[s++];){var l=f.parentNode;l.tagName=="DIV"&&l.childNodes.length==1&&(l.innerHTML="<p><br/></p>",v.remove(l))}var c=e.querySelectorAll("#baidu_pastebin");for(var s=0,h;h=c[s++];){var p=t.document.createElement("p");h.parentNode.insertBefore(p,h);while(h.firstChild)p.appendChild(h.firstChild);v.remove(h)}var d=e.querySelectorAll("meta");for(var s=0,m;m=d[s++];)v.remove(m);var u=e.querySelectorAll("br");for(s=0;m=u[s++];)/^apple-/i.test(m.className)&&v.remove(m)}if(n.gecko){var g=e.querySelectorAll("[_moz_dirty]");for(s=0;m=g[s++];)m.removeAttribute("_moz_dirty")}if(!n.ie){var y=e.querySelectorAll("span.Apple-style-span");for(var s=0,m;m=y[s++];)v.remove(m,!0)}r=e.innerHTML,r=UE.filterWord(r);var b=UE.htmlparser(r);t.options.filterRules&&UE.filterNode(b,t.options.filterRules),t.filterInputRule(b);if(n.webkit){var w=b.lastChild();w&&w.type=="element"&&w.tagName=="br"&&b.removeChild(w),a.each(t.body.querySelectorAll("div"),function(e){v.isEmptyBlock(e)&&v.remove(e,!0)})}r=b.toHtml(),r=r.replace(/[\n\r]/g,""),r=r.replace(/(<img.*?\/?>)/gi,'</p><p be-class="center">$1</p><p>'),r=r.replace(/<p>(<br\/?>|&nbsp;)<\/p>/gi,""),r=r.replace(/<br\/?>/gi,"</p><p>"),r=r.replace(/<p><\/p>/g,""),r=r.replace(new RegExp(v.fillChar,"g"),""),r=r.replace(/\u00a0/g,""),r=r.replace(/&nbsp;/g,""),t.fireEvent("beforepaste",{html:r},b);if(!r)return;t.execCommand("insertHtml",r,!0),t.fireEvent("afterpaste",{html:r})}}var t=this;t.addListener("ready",function(){v.on(t.body,"cut",function(){var e=t.selection.getRange();!e.collapsed&&t.undoManger&&t.undoManger.save()}),v.on(t.body,n.ie||n.opera?"keydown":"paste",function(i){if((n.ie||n.opera)&&(!i.ctrlKey&&!i.metaKey||i.keyCode!="86"))return;e.call(t,function(e){r(e)})})}),t.commands.paste={execCommand:function(i){n.ie?(e.call(t,function(e){r(e)}),t.document.execCommand("paste")):alert(t.getLang("pastemsg"))}}},UE.plugins.enterkey=function(){var e,t=this,r=t.options.enterTag;t.addListener("keyup",function(r,i){var s=i.keyCode||i.which;if(s==13){var o=t.selection.getRange(),u=o.startContainer,a;if(!n.ie){if(/h\d/i.test(e)){if(n.gecko){var f=v.findParentByTagName(u,["h1","h2","h3","h4","h5","h6","blockquote","caption","table"],!0);f||(t.document.execCommand("formatBlock",!1,"<p>"),a=1)}else if(u.nodeType==1){var l=t.document.createTextNode(""),c;o.insertNode(l),c=v.findParentByTagName(l,"div",!0);if(c){var h=t.document.createElement("p");while(c.firstChild)h.appendChild(c.firstChild);c.parentNode.insertBefore(h,c),v.remove(c),o.setStartBefore(l).setCursor(),a=1}v.remove(l)}t.undoManger&&a&&t.undoManger.save()}n.opera&&o.select()}else t.fireEvent("saveScene",!0,!0)}}),t.addListener("keydown",function(i,s){var o=s.keyCode||s.which;if(o==13){if(t.fireEvent("beforeenterkeydown")){v.preventDefault(s);return}t.fireEvent("saveScene",!0,!0),e="";var u=t.selection.getRange();if(!u.collapsed){var a=u.startContainer,f=u.endContainer,l=v.findParentByTagName(a,"td",!0),h=v.findParentByTagName(f,"td",!0);if(l&&h&&l!==h||!l&&h||l&&!h){s.preventDefault?s.preventDefault():s.returnValue=!1;return}}if(r=="p")n.ie||(a=v.findParentByTagName(u.startContainer,["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote","caption"],!0),!a&&!n.opera?(t.document.execCommand("formatBlock",!1,"<p>"),n.gecko&&(u=t.selection.getRange(),a=v.findParentByTagName(u.startContainer,"p",!0),a&&v.removeDirtyAttr(a))):(e=a.tagName,a.tagName.toLowerCase()=="p"&&n.gecko&&v.removeDirtyAttr(a)));else{s.preventDefault?s.preventDefault():s.returnValue=!1;if(!u.collapsed){u.deleteContents(),a=u.startContainer;if(a.nodeType==1&&(a=a.childNodes[u.startOffset])){while(a.nodeType==1){if(c.$empty[a.tagName])return u.setStartBefore(a).setCursor(),t.undoManger&&t.undoManger.save(),!1;if(!a.firstChild){var p=u.document.createElement("br");return a.appendChild(p),u.setStart(a,0).setCursor(),t.undoManger&&t.undoManger.save(),!1}a=a.firstChild}a===u.startContainer.childNodes[u.startOffset]?(p=u.document.createElement("br"),u.insertNode(p).setCursor()):u.setStart(a,0).setCursor()}else p=u.document.createElement("br"),u.insertNode(p).setStartAfter(p).setCursor()}else{p=u.document.createElement("br"),u.insertNode(p);var d=p.parentNode;d.lastChild===p?(p.parentNode.insertBefore(p.cloneNode(!0),p),u.setStartBefore(p)):u.setStartAfter(p),u.setCursor()}}}})},UE.plugins.keystrokes=function(){var e=this,t=!0;e.addListener("keydown",function(r,i){var s=i.keyCode||i.which,o=e.selection.getRange();if(!o.collapsed&&!(i.ctrlKey||i.shiftKey||i.altKey||i.metaKey)&&(s>=65&&s<=90||s>=48&&s<=57||s>=96&&s<=111||{13:1,8:1,46:1}[s])){var u=o.startContainer;v.isFillChar(u)&&o.setStartBefore(u),u=o.endContainer,v.isFillChar(u)&&o.setEndAfter(u),o.txtToElmBoundary(),o.endContainer&&o.endContainer.nodeType==1&&(u=o.endContainer.childNodes[o.endOffset],u&&v.isBr(u)&&o.setEndAfter(u));if(o.startOffset==0){u=o.startContainer;if(v.isBoundaryNode(u,"firstChild")){u=o.endContainer;if(o.endOffset==(u.nodeType==3?u.nodeValue.length:u.childNodes.length)&&v.isBoundaryNode(u,"lastChild")){e.fireEvent("saveScene"),e.body.innerHTML="<p>"+(n.ie?"":"<br/>")+"</p>",o.setStart(e.body.firstChild,0).setCursor(!1,!0),e._selectionChange();return}}}}if(s==w.Backspace){o=e.selection.getRange(),t=o.collapsed;if(e.fireEvent("delkeydown",i))return;var a,f;o.collapsed&&o.inFillChar()&&(a=o.startContainer,v.isFillChar(a)?(o.setStartBefore(a).shrinkBoundary(!0).collapse(!0),v.remove(a)):(a.nodeValue=a.nodeValue.replace(new RegExp("^"+v.fillChar),""),o.startOffset--,o.collapse(!0).select(!0)));if(a=o.getClosedNode()){e.fireEvent("saveScene"),o.setStartBefore(a),v.remove(a),o.setCursor(),e.fireEvent("saveScene"),v.preventDefault(i);return}if(!n.ie){a=v.findParentByTagName(o.startContainer,"table",!0),f=v.findParentByTagName(o.endContainer,"table",!0);if(a&&!f||!a&&f||a!==f){i.preventDefault();return}}}if(s==w.Tab){var l={ol:1,ul:1,table:1};if(e.fireEvent("tabkeydown",i)){v.preventDefault(i);return}var c=e.selection.getRange();e.fireEvent("saveScene");for(var h=0,p="",d=e.options.tabSize||4,m=e.options.tabNode||"&nbsp;";h<d;h++)p+=m;var g=e.document.createElement("span");g.innerHTML=p+v.fillChar;if(c.collapsed)c.insertNode(g.cloneNode(!0).firstChild).setCursor(!0);else{var y=function(e){return v.isBlockElm(e)&&!l[e.tagName.toLowerCase()]};a=v.findParent(c.startContainer,y,!0),f=v.findParent(c.endContainer,y,!0);if(a&&f&&a===f)c.deleteContents(),c.insertNode(g.cloneNode(!0).firstChild).setCursor(!0);else{var b=c.createBookmark();c.enlarge(!0);var E=c.createBookmark(),S=v.getNextDomNode(E.start,!1,y);while(S&&!(v.getPosition(S,E.end)&v.POSITION_FOLLOWING))S.insertBefore(g.cloneNode(!0).firstChild,S.firstChild),S=v.getNextDomNode(S,!1,y);c.moveToBookmark(E).moveToBookmark(b).select()}}v.preventDefault(i)}if(n.gecko&&s==46){c=e.selection.getRange();if(c.collapsed){a=c.startContainer;if(v.isEmptyBlock(a)){var x=a.parentNode;while(v.getChildCount(x)==1&&!v.isBody(x))a=x,x=x.parentNode;a===x.lastChild&&i.preventDefault();return}}}}),e.addListener("keyup",function(e,r){var i=r.keyCode||r.which,s,o=this;if(i==w.Backspace){if(o.fireEvent("delkeyup"))return;s=o.selection.getRange();if(s.collapsed){var u,a=["h1","h2","h3","h4","h5","h6"];if(u=v.findParentByTagName(s.startContainer,a,!0))if(v.isEmptyBlock(u)){var f=u.previousSibling;if(f&&f.nodeName!="TABLE"){v.remove(u),s.setStartAtLast(f).setCursor(!1,!0);return}var l=u.nextSibling;if(l&&l.nodeName!="TABLE"){v.remove(u),s.setStartAtFirst(l).setCursor(!1,!0);return}}if(v.isBody(s.startContainer)){var u=v.createElement(o.document,"p",{innerHTML:n.ie?v.fillChar:"<br/>"});s.insertNode(u).setStart(u,0).setCursor(!1,!0)}}if(!t&&(s.startContainer.nodeType==3||s.startContainer.nodeType==1&&v.isEmptyBlock(s.startContainer)))if(n.ie){var c=s.document.createElement("span");s.insertNode(c).setStartBefore(c).collapse(!0),s.select(),v.remove(c)}else s.select()}})},UE.plugins.fiximgclick=function(){function r(){this.editor=null,this.resizer=null,this.cover=null,this.doc=document,this.prePos={x:0,y:0},this.startPos={x:0,y:0}}var e=!1;return function(){var t=[[0,0,-1,-1],[0,0,0,-1],[0,0,1,-1],[0,0,-1,0],[0,0,1,0],[0,0,-1,1],[0,0,0,1],[0,0,1,1]];r.prototype={init:function(e){var t=this;t.editor=e,t.startPos=this.prePos={x:0,y:0},t.dragId=-1;var n=[],r=t.cover=document.createElement("div"),s=t.resizer=document.createElement("div");r.id=t.editor.ui.id+"_imagescale_cover",r.style.cssText="position:absolute;display:none;z-index:"+t.editor.options.zIndex+";filter:alpha(opacity=0); opacity:0;background:#CCC;",v.on(r,"mousedown click",function(){t.hide()});for(i=0;i<8;i++)n.push('<span class="edui-editor-imagescale-hand'+i+'"></span>');s.id=t.editor.ui.id+"_imagescale",s.className="edui-editor-imagescale",s.innerHTML=n.join(""),s.style.cssText+=";display:none;border:1px solid #3b77ff;z-index:"+t.editor.options.zIndex+";",t.editor.ui.getDom().appendChild(r),t.editor.ui.getDom().appendChild(s),t.initStyle(),t.initEvents()},initStyle:function(){a.cssRule("imagescale",".edui-editor-imagescale{display:none;position:absolute;border:1px solid #38B2CE;cursor:hand;-webkit-box-sizing: content-box;-moz-box-sizing: content-box;box-sizing: content-box;}.edui-editor-imagescale span{position:absolute;width:6px;height:6px;overflow:hidden;font-size:0px;display:block;background-color:#3C9DD0;}.edui-editor-imagescale .edui-editor-imagescale-hand0{cursor:nw-resize;top:0;margin-top:-4px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand1{cursor:n-resize;top:0;margin-top:-4px;left:50%;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand2{cursor:ne-resize;top:0;margin-top:-4px;left:100%;margin-left:-3px;}.edui-editor-imagescale .edui-editor-imagescale-hand3{cursor:w-resize;top:50%;margin-top:-4px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand4{cursor:e-resize;top:50%;margin-top:-4px;left:100%;margin-left:-3px;}.edui-editor-imagescale .edui-editor-imagescale-hand5{cursor:sw-resize;top:100%;margin-top:-3px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand6{cursor:s-resize;top:100%;margin-top:-3px;left:50%;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand7{cursor:se-resize;top:100%;margin-top:-3px;left:100%;margin-left:-3px;}")},initEvents:function(){var e=this;e.startPos.x=e.startPos.y=0,e.isDraging=!1},_eventHandler:function(t){var n=this;switch(t.type){case"mousedown":var r=t.target||t.srcElement,r;r.className.indexOf("edui-editor-imagescale-hand")!=-1&&n.dragId==-1&&(n.dragId=r.className.slice(-1),n.startPos.x=n.prePos.x=t.clientX,n.startPos.y=n.prePos.y=t.clientY,v.on(n.doc,"mousemove",n.proxy(n._eventHandler,n)));break;case"mousemove":n.dragId!=-1&&(n.updateContainerStyle(n.dragId,{x:t.clientX-n.prePos.x,y:t.clientY-n.prePos.y}),n.prePos.x=t.clientX,n.prePos.y=t.clientY,e=!0,n.updateTargetElement());break;case"mouseup":n.dragId!=-1&&(n.updateContainerStyle(n.dragId,{x:t.clientX-n.prePos.x,y:t.clientY-n.prePos.y}),n.updateTargetElement(),n.target.parentNode&&n.attachTo(n.target),n.dragId=-1),v.un(n.doc,"mousemove",n.proxy(n._eventHandler,n)),e&&(e=!1,n.editor.fireEvent("contentchange"));break;default:}},updateTargetElement:function(){var e=this;v.setStyles(e.target,{width:e.resizer.style.width,height:e.resizer.style.height}),e.target.width=parseInt(e.resizer.style.width),e.target.height=parseInt(e.resizer.style.height),e.attachTo(e.target)},updateContainerStyle:function(e,n){var r=this,i=r.resizer,s;t[e][0]!=0&&(s=parseInt(i.style.left)+n.x,i.style.left=r._validScaledProp("left",s)+"px"),t[e][1]!=0&&(s=parseInt(i.style.top)+n.y,i.style.top=r._validScaledProp("top",s)+"px"),t[e][2]!=0&&(s=i.clientWidth+t[e][2]*n.x,i.style.width=r._validScaledProp("width",s)+"px"),t[e][3]!=0&&(s=i.clientHeight+t[e][3]*n.y,i.style.height=r._validScaledProp("height",s)+"px")},_validScaledProp:function(e,t){var n=this.resizer,r=document;t=isNaN(t)?0:t;switch(e){case"left":return t<0?0:t+n.clientWidth>r.clientWidth?r.clientWidth-n.clientWidth:t;case"top":return t<0?0:t+n.clientHeight>r.clientHeight?r.clientHeight-n.clientHeight:t;case"width":return t<=0?1:t+n.offsetLeft>r.clientWidth?r.clientWidth-n.offsetLeft:t;case"height":return t<=0?1:t+n.offsetTop>r.clientHeight?r.clientHeight-n.offsetTop:t}},hideCover:function(){this.cover.style.display="none"},showCover:function(){var e=this,t=v.getXY(e.editor.ui.getDom()),n=v.getXY(e.editor.iframe);v.setStyles(e.cover,{width:e.editor.iframe.offsetWidth+"px",height:e.editor.iframe.offsetHeight+"px",top:n.y-t.y+"px",left:n.x-t.x+"px",position:"absolute",display:""})},show:function(e){var t=this;t.resizer.style.display="block",e&&t.attachTo(e),v.on(this.resizer,"mousedown",t.proxy(t._eventHandler,t)),v.on(t.doc,"mouseup",t.proxy(t._eventHandler,t)),t.showCover(),t.editor.fireEvent("afterscaleshow",t),t.editor.fireEvent("saveScene")},hide:function(){var e=this;e.hideCover(),e.resizer.style.display="none",v.un(e.resizer,"mousedown",e.proxy(e._eventHandler,e)),v.un(e.doc,"mouseup",e.proxy(e._eventHandler,e)),e.editor.fireEvent("afterscalehide",e)},proxy:function(e,t){return function(n){return e.apply(t||this,arguments)}},attachTo:function(e){var t=this,n=t.target=e,r=this.resizer,i=v.getXY(n),s=v.getXY(t.editor.iframe),o=v.getXY(r.parentNode);v.setStyles(r,{width:n.width+"px",height:n.height+"px",left:s.x+i.x-t.editor.document.body.scrollLeft-o.x-parseInt(r.style.borderLeftWidth)+"px",top:s.y+i.y-t.editor.document.body.scrollTop-o.y-parseInt(r.style.borderTopWidth)+"px"})}}}(),function(){var e=this,i;e.setOpt("imageScaleEnabled",!0),!n.ie&&e.options.imageScaleEnabled&&e.addListener("click",function(t,n){var s=e.selection.getRange(),o=s.getClosedNode();if(o&&o.tagName=="IMG"&&e.body.contentEditable!="false"){if(o.className.indexOf("edui-faked-music")!=-1||o.getAttribute("anchorname")||v.hasClass(o,"loadingclass")||v.hasClass(o,"loaderrorclass"))return;if(!i){i=new r,i.init(e),e.ui.getDom().appendChild(i.resizer);var u=function(t){i.hide(),i.target&&e.selection.getRange().selectNode(i.target).select()},a=function(e){var t=e.target||e.srcElement;t&&(t.className===undefined||t.className.indexOf("edui-editor-imagescale")==-1)&&u(e)},f;e.addListener("afterscaleshow",function(t){e.addListener("beforekeydown",u),e.addListener("beforemousedown",a),v.on(document,"keydown",u),v.on(document,"mousedown",a),e.selection.getNative().removeAllRanges()}),e.addListener("afterscalehide",function(t){e.removeListener("beforekeydown",u),e.removeListener("beforemousedown",a),v.un(document,"keydown",u),v.un(document,"mousedown",a);var n=i.target;n.parentNode&&e.selection.getRange().selectNode(n).select()}),v.on(i.resizer,"mousedown",function(t){e.selection.getNative().removeAllRanges();var n=t.target||t.srcElement;n&&n.className.indexOf("edui-editor-imagescale-hand")==-1&&(f=setTimeout(function(){i.hide(),i.target&&e.selection.getRange().selectNode(n).select()},200))}),v.on(i.resizer,"mouseup",function(e){var t=e.target||e.srcElement;t&&t.className.indexOf("edui-editor-imagescale-hand")==-1&&clearTimeout(f)})}i.show(o)}else i&&i.resizer.style.display!="none"&&i.hide()}),n.webkit&&e.addListener("click",function(n,r){if(r.target.tagName=="IMG"&&e.body.contentEditable!="false"){var i=new t.Range(e.document);i.selectNode(r.target).select()}})}}(),UE.plugins.autoheight=function(){function u(){var e=this;clearTimeout(o);if(a)return;if(!e.queryCommandState||e.queryCommandState&&e.queryCommandState("source")!=1)o=setTimeout(function(){var t=e.body.lastChild;while(t&&t.nodeType!=1)t=t.previousSibling;t&&t.nodeType==1&&(t.style.clear="both",s=Math.max(v.getXY(t).y+t.offsetHeight+25,Math.max(i.minFrameHeight,i.initialFrameHeight)),s!=r&&(s!==parseInt(e.iframe.parentNode.style.height)&&(e.iframe.parentNode.style.height=s+"px"),e.body.style.height=s+"px",r=s),v.removeStyle(t,"clear"))},50)}var e=this;e.autoHeightEnabled=e.options.autoHeightEnabled!==!1;if(!e.autoHeightEnabled)return;var t,r=0,i=e.options,s,o,a;e.addListener("fullscreenchanged",function(e,t){a=t}),e.addListener("destroy",function(){e.removeListener("contentchange afterinserthtml keyup mouseup",u)}),e.enableAutoHeight=function(){var e=this;if(!e.autoHeightEnabled)return;var r=e.document;e.autoHeightEnabled=!0,t=r.body.style.overflowY,r.body.style.overflowY="hidden",e.addListener("contentchange afterinserthtml keyup mouseup",u),setTimeout(function(){u.call(e)},n.gecko?100:0),e.fireEvent("autoheightchanged",e.autoHeightEnabled)},e.disableAutoHeight=function(){e.body.style.overflowY=t||"",e.removeListener("contentchange",u),e.removeListener("keyup",u),e.removeListener("mouseup",u),e.autoHeightEnabled=!1,e.fireEvent("autoheightchanged",e.autoHeightEnabled)},e.on("setHeight",function(){e.disableAutoHeight()}),e.addListener("ready",function(){e.enableAutoHeight();var t;v.on(n.ie?e.body:e.document,n.webkit?"dragover":"drop",function(){clearTimeout(t),t=setTimeout(function(){u.call(e)},100)});var r;window.onscroll=function(){r===null?r=this.scrollY:this.scrollY==0&&r!=0&&(e.window.scrollTo(0,0),r=null)}})},UE.plugins.autofloat=function(){function f(){return UE.ui?1:(alert(t.autofloatMsg),0)}function l(){var e=document.body.style;e.backgroundImage='url("about:blank")',e.backgroundAttachment="fixed"}function y(){var t=v.getXY(p),r=v.getComputedStyle(p,"position"),s=v.getComputedStyle(p,"left");p.style.width=p.offsetWidth+"px",p.style.zIndex=e.options.zIndex*1+1,p.parentNode.insertBefore(h,p),o||u&&n.ie?(p.style.position!="absolute"&&(p.style.position="absolute"),p.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-d+i+"px"):(n.ie7Compat&&g&&(g=!1,p.style.left=v.getXY(p).x-document.documentElement.getBoundingClientRect().left+2+"px"),p.style.position!="fixed"&&(p.style.position="fixed",p.style.top=i+"px",(r=="absolute"||r=="relative")&&parseFloat(s)&&(p.style.left=t.x+"px")))}function b(){g=!0,h.parentNode&&h.parentNode.removeChild(h),p.style.cssText=c}function w(){var t=m(e.container),n=e.options.toolbarTopOffset||0;t.top<0&&t.bottom-p.offsetHeight>n?y():b()}var e=this,t=e.getLang();e.setOpt({topOffset:0});var r=e.options.autoFloatEnabled!==!1,i=e.options.topOffset;if(!r)return;var s=UE.ui.uiUtils,o=n.ie&&n.version<=6,u=n.quirks,c,h=document.createElement("div"),p,d,m,g=!0,E=a.defer(function(){w()},n.ie?200:100,!0);e.addListener("destroy",function(){v.un(window,["scroll","resize"],w),e.removeListener("keydown",E)}),e.addListener("ready",function(){if(f(e)){if(!e.ui)return;m=s.getClientRect,p=e.ui.getDom("toolbarbox"),d=m(p).top,c=p.style.cssText,h.style.height=p.offsetHeight+"px",o&&l(),v.on(window,["scroll","resize"],w),e.addListener("keydown",E),e.addListener("beforefullscreenchange",function(e,t){t&&b()}),e.addListener("fullscreenchanged",function(e,t){t||w()}),e.addListener("sourcemodechanged",function(e,t){setTimeout(function(){w()},0)}),e.addListener("clearDoc",function(){setTimeout(function(){w()},0)})}})},UE.plugins.basestyle=function(){var e={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},t=function(e,t){return v.filterNodeList(e.selection.getStartElementPath(),t)},n=this;n.addshortcutkey({Bold:"ctrl+66",Italic:"ctrl+73",Underline:"ctrl+85"}),n.addInputRule(function(e){a.each(e.getNodesByTagName("b i"),function(e){switch(e.tagName){case"b":e.tagName="strong";break;case"i":e.tagName="em"}})});for(var r in e)(function(e,r){n.commands[e]={execCommand:function(e){var i=n.selection.getRange(),s=t(this,r);if(i.collapsed){if(s){var o=n.document.createTextNode("");i.insertNode(o).removeInlineStyle(r),i.setStartBefore(o),v.remove(o)}else{var u=i.document.createElement(r[0]);if(e=="superscript"||e=="subscript")o=n.document.createTextNode(""),i.insertNode(o).removeInlineStyle(["sub","sup"]).setStartBefore(o).collapse(!0);i.insertNode(u).setStart(u,0)}i.collapse(!0)}else(e=="superscript"||e=="subscript")&&(!s||s.tagName.toLowerCase()!=e)&&i.removeInlineStyle(["sub","sup"]),s?i.removeInlineStyle(r):i.applyInlineStyle(r[0]);i.select()},queryCommandState:function(){return t(this,r)?1:0}}})(r,e[r])},UE.plugins.xssFilter=function(){function n(e){var n=e.tagName,r=e.attrs;UE.utils.each(r,function(r,i){t[n].indexOf(i)===-1&&e.setAttr(i)})}var e=UEDITOR_CONFIG,t=e.whitList;t&&e.xssFilterRules&&(this.options.filterRules=function(){var e={},r=[];return t["+"]&&(r=t["+"].split(" ")),UE.utils.each(r,function(e){t[e]=[]}),UE.utils.each(t,function(t,r){e[r]=function(e){return n(e)}}),e["-"]=t["-"],e}())};var e=e||{};e.editor=e.editor||{},UE.ui=e.editor.ui={},function(){function a(){var e=document.getElementById("edui_fixedlayer");u.setViewportOffset(e,{left:0,top:0})}function f(t){n.on(window,"scroll",a),n.on(window,"resize",e.editor.utils.defer(a,0,!0))}var t=e.editor.browser,n=e.editor.dom.domUtils,r="$EDITORUI",i=window[r]={},s="ID"+r,o=0,u=e.editor.ui.uiUtils={uid:function(e){return e?e[s]||(e[s]=++o):++o},hook:function(e,t){var n;return e&&e._callbacks?n=e:(n=function(){var t;e&&(t=e.apply(this,arguments));var r=n._callbacks,i=r.length;while(i--){var s=r[i].apply(this,arguments);t===undefined&&(t=s)}return t},n._callbacks=[]),n._callbacks.push(t),n},createElementByHtml:function(e){var t=document.createElement("div");return t.innerHTML=e,t=t.firstChild,t.parentNode.removeChild(t),t},getViewportElement:function(){return t.ie&&t.quirks?document.body:document.documentElement},getClientRect:function(e){var t;try{t=e.getBoundingClientRect()}catch(r){t={left:0,top:0,height:0,width:0}}var i={left:Math.round(t.left),top:Math.round(t.top),height:Math.round(t.bottom-t.top),width:Math.round(t.right-t.left)},s;while((s=e.ownerDocument)!==document&&(e=n.getWindow(s).frameElement))t=e.getBoundingClientRect(),i.left+=t.left,i.top+=t.top;return i.bottom=i.top+i.height,i.right=i.left+i.width,i},getViewportRect:function(){var e=u.getViewportElement(),t=(window.innerWidth||e.clientWidth)|0,n=(window.innerHeight||e.clientHeight)|0;return{left:0,top:0,height:n,width:t,bottom:n,right:t}},setViewportOffset:function(e,t){var r,i=u.getFixedLayer();e.parentNode===i?(e.style.left=t.left+"px",e.style.top=t.top+"px"):n.setViewportOffset(e,t)},getEventOffset:function(e){var t=e.target||e.srcElement,n=u.getClientRect(t),r=u.getViewportOffsetByEvent(e);return{left:r.left-n.left,top:r.top-n.top}},getViewportOffsetByEvent:function(e){var t=e.target||e.srcElement,r=n.getWindow(t).frameElement,i={left:e.clientX,top:e.clientY};if(r&&t.ownerDocument!==document){var s=u.getClientRect(r);i.left+=s.left,i.top+=s.top}return i},setGlobal:function(e,t){return i[e]=t,r+'["'+e+'"]'},unsetGlobal:function(e){delete i[e]},copyAttributes:function(e,r){var i=r.attributes,s=i.length;while(s--){var o=i[s];o.nodeName!="style"&&o.nodeName!="class"&&(!t.ie||o.specified)&&e.setAttribute(o.nodeName,o.nodeValue)}r.className&&n.addClass(e,r.className),r.style.cssText&&(e.style.cssText+=";"+r.style.cssText)},removeStyle:function(e,t){if(e.style.removeProperty)e.style.removeProperty(t);else{if(!e.style.removeAttribute)throw"";e.style.removeAttribute(t)}},contains:function(e,t){return e&&t&&(e===t?!1:e.contains?e.contains(t):e.compareDocumentPosition(t)&16)},startDrag:function(e,t,n){function s(e){var n=e.clientX-r,s=e.clientY-i;t.ondragmove(n,s,e),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}var n=n||document,r=e.clientX,i=e.clientY;if(n.addEventListener){function o(e){n.removeEventListener("mousemove",s,!0),n.removeEventListener("mouseup",o,!0),window.removeEventListener("mouseup",o,!0),t.ondragstop()}n.addEventListener("mousemove",s,!0),n.addEventListener("mouseup",o,!0),window.addEventListener("mouseup",o,!0),e.preventDefault()}else{var u=e.srcElement;u.setCapture();function a(){u.releaseCapture(),u.detachEvent("onmousemove",s),u.detachEvent("onmouseup",a),u.detachEvent("onlosecaptrue",a),t.ondragstop()}u.attachEvent("onmousemove",s),u.attachEvent("onmouseup",a),u.attachEvent("onlosecaptrue",a),e.returnValue=!1}t.ondragstart()},getFixedLayer:function(){var e=document.getElementById("edui_fixedlayer");return e==null&&(e=document.createElement("div"),e.id="edui_fixedlayer",document.body.appendChild(e),t.ie&&t.version<=8?(e.style.position="absolute",f(),setTimeout(a)):e.style.position="fixed",e.style.left="0",e.style.top="0",e.style.width="0",e.style.height="0"),e},makeUnselectable:function(e){if(t.opera||t.ie&&t.version<9){e.unselectable="on";if(e.hasChildNodes())for(var n=0;n<e.childNodes.length;n++)e.childNodes[n].nodeType==1&&u.makeUnselectable(e.childNodes[n])}else e.style.MozUserSelect!==undefined?e.style.MozUserSelect="none":e.style.WebkitUserSelect!==undefined?e.style.WebkitUserSelect="none":e.style.KhtmlUserSelect!==undefined&&(e.style.KhtmlUserSelect="none")}}}(),function(){var t=e.editor.utils,n=e.editor.ui.uiUtils,r=e.editor.EventBase,i=e.editor.ui.UIBase=function(){};i.prototype={className:"",uiName:"",initOptions:function(e){var t=this;for(var r in e)t[r]=e[r];this.id=this.id||"edui"+n.uid()},initUIBase:function(){this._globalKey=t.unhtml(n.setGlobal(this.id,this))},render:function(e){var t=this.renderHtml(),r=n.createElementByHtml(t),i=v.getElementsByTagName(r,"*"),s="edui-"+(this.theme||this.editor.options.theme),o=document.getElementById("edui_fixedlayer");for(var u=0,a;a=i[u++];)v.addClass(a,s);v.addClass(r,s),o&&(o.className="",v.addClass(o,s));var f=this.getDom();f!=null?(f.parentNode.replaceChild(r,f),n.copyAttributes(r,f)):(typeof e=="string"&&(e=document.getElementById(e)),e=e||n.getFixedLayer(),v.addClass(e,s),e.appendChild(r)),this.postRender()},getDom:function(e){return e?document.getElementById(this.id+"_"+e):document.getElementById(this.id)},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(e){var t="edui-"+this.uiName;return e.replace(/##/g,this.id).replace(/%%-/g,this.uiName?t+"-":"").replace(/%%/g,(this.uiName?t:"")+" "+this.className).replace(/\$\$/g,this._globalKey)},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var t=this.getDom();t&&e.editor.dom.domUtils.remove(t),n.unsetGlobal(this.id)}},t.inherits(i,r)}(),function(){var t=e.editor.utils,n=e.editor.ui.UIBase,r=e.editor.ui.Separator=function(e){this.initOptions(e),this.initSeparator()};r.prototype={uiName:"separator",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>'}},t.inherits(r,n)}(),function(){function u(e,t){for(var n=0;n<o.length;n++){var r=o[n];if(!r.isHidden()&&r.queryAutoHide(t)!==!1){if(e&&/scroll/ig.test(e.type)&&r.className=="edui-wordpastepop")return;r.hide()}}o.length&&r.editor.fireEvent("afterhidepop")}var t=e.editor.utils,n=e.editor.ui.uiUtils,r=e.editor.dom.domUtils,i=e.editor.ui.UIBase,s=e.editor.ui.Popup=function(e){this.initOptions(e),this.initPopup()},o=[];s.postHide=u;var a=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];s.prototype={SHADOW_RADIUS:5,content:null,_hidden:!1,autoRender:!0,canSideLeft:!0,canSideUp:!0,initPopup:function(){this.initUIBase(),o.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%" onmousedown="return false;"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="about:blank"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div>"+" </div>"+"</div>"},getContentHtmlTpl:function(){return this.content?typeof this.content=="string"?this.content:this.content.renderHtml():""},_UIBase_postRender:i.prototype.postRender,postRender:function(){this.content instanceof i&&this.content.postRender();if(this.captureWheel&&!this.captured){this.captured=!0;var e=(document.documentElement.clientHeight||document.body.clientHeight)-80,t=this.getDom().offsetHeight,s=n.getClientRect(this.combox.getDom()).top,o=this.getDom("content"),u=this.getDom("body").getElementsByTagName("iframe"),a=this;u.length&&(u=u[0]);while(s+t>e)t-=30;o.style.height=t+"px",u&&(u.style.height=t+"px"),window.XMLHttpRequest?r.on(o,"onmousewheel"in document.body?"mousewheel":"DOMMouseScroll",function(e){e.preventDefault?e.preventDefault():e.returnValue=!1,e.wheelDelta?o.scrollTop-=e.wheelDelta/120*60:o.scrollTop-=e.detail/-3*60}):r.on(this.getDom(),"mousewheel",function(e){e.returnValue=!1,a.getDom("content").scrollTop-=e.wheelDelta/120*60})}this.fireEvent("postRenderAfter"),this.hide(!0),this._UIBase_postRender()},_doAutoRender:function(){!this.getDom()&&this.autoRender&&this.render()},mesureSize:function(){var e=this.getDom("content");return n.getClientRect(e)},fitSize:function(){if(this.captureWheel&&this.sized)return this.__size;this.sized=!0;var e=this.getDom("body");e.style.width="",e.style.height="";var t=this.mesureSize();if(this.captureWheel){e.style.width=-(-20-t.width)+"px";var n=parseInt(this.getDom("content").style.height,10);!window.isNaN(n)&&(t.height=n)}else e.style.width=t.width+"px";return e.style.height=t.height+"px",this.__size=t,this.captureWheel&&(this.getDom("content").style.overflow="auto"),t},showAnchor:function(e,t){this.showAnchorRect(n.getClientRect(e),t)},showAnchorRect:function(t,i,s){this._doAutoRender();var o=n.getViewportRect();this.getDom().style.visibility="hidden",this._show();var u=this.fitSize(),f,l,c,h;i?(f=this.canSideLeft&&t.right+u.width>o.right&&t.left>u.width,l=this.canSideUp&&t.top+u.height>o.bottom&&t.bottom>u.height,c=f?t.left-u.width:t.right,h=l?t.bottom-u.height:t.top):(f=this.canSideLeft&&t.right+u.width>o.right&&t.left>u.width,l=this.canSideUp&&t.top+u.height>o.bottom&&t.bottom>u.height,c=f?t.right-u.width:t.left,h=l?t.top-u.height:t.bottom);var p=this.getDom();n.setViewportOffset(p,{left:c,top:h}),r.removeClasses(p,a),p.className+=" "+a[(l?1:0)*2+(f?1:0)],this.editor&&(p.style.zIndex=this.editor.container.style.zIndex*1+10,e.editor.ui.uiUtils.getFixedLayer().style.zIndex=p.style.zIndex-1),this.getDom().style.visibility="visible"},showAt:function(e){var t=e.left,n=e.top,r={left:t,top:n,right:t,bottom:n,height:0,width:0};this.showAnchorRect(r,!1,!0)},_show:function(){if(this._hidden){var e=this.getDom();e.style.display="",this._hidden=!1,this.fireEvent("show")}},isHidden:function(){return this._hidden},show:function(){this._doAutoRender(),this._show()},hide:function(e){!this._hidden&&this.getDom()&&(this.getDom().style.display="none",this._hidden=!0,e||this.fireEvent("hide"))},queryAutoHide:function(e){return!e||!n.contains(this.getDom(),e)}},t.inherits(s,i),r.on(document,"mousedown",function(e){var t=e.target||e.srcElement;u(e,t)}),r.on(window,"scroll",function(e,t){u(e,t)})}(),function(){var t=e.editor.browser,n=e.editor.dom.domUtils,r=e.editor.ui.uiUtils,i='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(t.ie?' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"':' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"');e.editor.ui.Stateful={alwalysHoverable:!1,target:null,Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl,this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){var e=this._Stateful_dGetHtmlTpl();return e.replace(/stateful/g,function(){return i})},Stateful_onMouseEnter:function(e,t){this.target=t;if(!this.isDisabled()||this.alwalysHoverable)this.addState("hover"),this.fireEvent("over")},Stateful_onMouseLeave:function(e,t){if(!this.isDisabled()||this.alwalysHoverable)this.removeState("hover"),this.removeState("active"),this.fireEvent("out")},Stateful_onMouseOver:function(e,t){var n=e.relatedTarget;!r.contains(t,n)&&t!==n&&this.Stateful_onMouseEnter(e,t)},Stateful_onMouseOut:function(e,t){var n=e.relatedTarget;!r.contains(t,n)&&t!==n&&this.Stateful_onMouseLeave(e,t)},Stateful_onMouseDown:function(e,t){this.isDisabled()||this.addState("active")},Stateful_onMouseUp:function(e,t){this.isDisabled()||this.removeState("active")},Stateful_postRender:function(){this.disabled&&!this.hasState("disabled")&&this.addState("disabled")},hasState:function(e){return n.hasClass(this.getStateDom(),"edui-state-"+e)},addState:function(e){this.hasState(e)||(this.getStateDom().className+=" edui-state-"+e)},removeState:function(e){this.hasState(e)&&n.removeClasses(this.getStateDom(),["edui-state-"+e])},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(e){!this.isDisabled()&&e?this.addState("checked"):this.removeState("checked")},isDisabled:function(){return this.hasState("disabled"
)},setDisabled:function(e){e?(this.removeState("hover"),this.removeState("checked"),this.removeState("active"),this.addState("disabled")):this.removeState("disabled")}}}(),function(){var t=e.editor.utils,n=e.editor.ui.UIBase,r=e.editor.ui.Stateful,i=e.editor.ui.Button=function(e){if(e.name){var t=e.name,n=e.cssRules;e.className||(e.className="edui-for-"+t),e.cssRules=".edui-default  .edui-for-"+t+" .edui-icon {"+n+"}"}this.initOptions(e),this.initButton()};i.prototype={uiName:"button",label:"",title:"",showIcon:!0,showText:!0,cssRules:"",initButton:function(){this.initUIBase(),this.Stateful_init(),this.cssRules&&t.cssRule("edui-customize-"+this.name+"-style",this.cssRules)},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return $$._onMouseDown(event, this);" onclick="return $$._onClick(event, this);">'+(this.showIcon?'<div class="edui-box edui-icon"></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+"</div>"+"</div>"+"</div></div>"},postRender:function(){this.Stateful_postRender(),this.setDisabled(this.disabled)},_onMouseDown:function(e){var t=e.target||e.srcElement,n=t&&t.tagName&&t.tagName.toLowerCase();if(n=="input"||n=="object"||n=="object")return!1},_onClick:function(){this.isDisabled()||this.fireEvent("click")},setTitle:function(e){var t=this.getDom("label");t.innerHTML=e}},t.inherits(i,n),t.extend(i.prototype,r)}(),function(){var t=e.editor.utils,n=e.editor.ui.uiUtils,r=e.editor.dom.domUtils,i=e.editor.ui.UIBase,s=e.editor.ui.Stateful,o=e.editor.ui.SplitButton=function(e){this.initOptions(e),this.initSplitButton()};o.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){this.initUIBase(),this.Stateful_init();var e=this;if(this.popup!=null){var t=this.popup;this.popup=null,this.setPopup(t)}},_UIBase_postRender:i.prototype.postRender,postRender:function(){this.Stateful_postRender(),this._UIBase_postRender()},setPopup:function(e){if(this.popup===e)return;this.popup!=null&&this.popup.dispose(),e.addListener("show",t.bind(this._onPopupShow,this)),e.addListener("hide",t.bind(this._onPopupHide,this)),e.addListener("postrender",t.bind(function(){e.getDom("body").appendChild(n.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(n.getClientRect(this.getDom()).width+20)+'px"></div>')),e.getDom().className+=" "+this.className},this)),this.popup=e},_onPopupShow:function(){this.addState("opened")},_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body">'+'<div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);">'+'<div class="edui-box edui-icon"></div>'+"</div>"+'<div class="edui-box edui-splitborder"></div>'+'<div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div>'+"</div></div></div>"},showPopup:function(){var e=n.getClientRect(this.getDom());e.top-=this.popup.SHADOW_RADIUS,e.height+=this.popup.SHADOW_RADIUS,this.popup.showAnchorRect(e)},_onArrowClick:function(e,t){this.isDisabled()||this.showPopup()},_onButtonClick:function(){this.isDisabled()||this.fireEvent("buttonclick")}},t.inherits(o,i),t.extend(o.prototype,s,!0)}(),function(){var t=e.editor.utils,n=e.editor.ui.uiUtils,r=e.editor.ui.UIBase,i=e.editor.ui.Toolbar=function(e){this.initOptions(e),this.initToolbar()};i.prototype={items:null,initToolbar:function(){this.items=this.items||[],this.initUIBase()},add:function(e,t){t===undefined?this.items.push(e):this.items.splice(t,0,e)},getHtmlTpl:function(){var e=[];for(var t=0;t<this.items.length;t++)e[t]=this.items[t].renderHtml();return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+e.join("")+"</div>"},postRender:function(){var e=this.getDom();for(var t=0;t<this.items.length;t++)this.items[t].postRender();n.makeUnselectable(e)},_onMouseDown:function(e){var t=e.target||e.srcElement,n=t&&t.tagName&&t.tagName.toLowerCase();if(n=="input"||n=="object"||n=="object")return!1}},t.inherits(i,r)}(),function(){var t=e.editor.utils,n=e.editor.dom.domUtils,r=e.editor.ui.uiUtils,i=e.editor.ui.UIBase,s=e.editor.ui.Popup,o=e.editor.ui.Stateful,u=e.editor.ui.CellAlignPicker,a=e.editor.ui.Menu=function(e){this.initOptions(e),this.initMenu()},f={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>'},postRender:function(){},queryAutoHide:function(){return!0}};a.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||[],this.initPopup(),this.initItems()},initItems:function(){for(var e=0;e<this.items.length;e++){var t=this.items[e];t=="-"?this.items[e]=this.getSeparator():t instanceof l||(t.editor=this.editor,t.theme=this.editor.options.theme,this.items[e]=this.createItem(t))}},getSeparator:function(){return f},createItem:function(e){return e.menu=this,new l(e)},_Popup_getContentHtmlTpl:s.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){if(this.items.length==0)return this._Popup_getContentHtmlTpl();var e=[];for(var t=0;t<this.items.length;t++){var n=this.items[t];e[t]=n.renderHtml()}return'<div class="%%-body">'+e.join("")+"</div>"},_Popup_postRender:s.prototype.postRender,postRender:function(){var e=this;for(var t=0;t<this.items.length;t++){var i=this.items[t];i.ownerMenu=this,i.postRender()}n.on(this.getDom(),"mouseover",function(t){t=t||event;var n=t.relatedTarget||t.fromElement,i=e.getDom();!r.contains(i,n)&&i!==n&&e.fireEvent("over")}),this._Popup_postRender()},queryAutoHide:function(e){if(e){if(r.contains(this.getDom(),e))return!1;for(var t=0;t<this.items.length;t++){var n=this.items[t];if(n.queryAutoHide(e)===!1)return!1}}},clearItems:function(){for(var e=0;e<this.items.length;e++){var t=this.items[e];clearTimeout(t._showingTimer),clearTimeout(t._closingTimer),t.subMenu&&t.subMenu.destroy()}this.items=[]},destroy:function(){this.getDom()&&n.remove(this.getDom()),this.clearItems()},dispose:function(){this.destroy()}},t.inherits(a,s);var l=e.editor.ui.MenuItem=function(e){this.initOptions(e),this.initUIBase(),this.Stateful_init();if(this.subMenu&&!(this.subMenu instanceof a))if(e.className&&e.className.indexOf("aligntd")!=-1){var t=this;this.subMenu.selected=this.editor.queryCommandValue("cellalignment"),this.subMenu=new s({content:new u(this.subMenu),parentMenu:t,editor:t.editor,destroy:function(){this.getDom()&&n.remove(this.getDom())}}),this.subMenu.addListener("postRenderAfter",function(){n.on(this.getDom(),"mouseover",function(){t.addState("opened")})})}else this.subMenu=new a(this.subMenu)};l.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:!0,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"</div>"+"</div>"},postRender:function(){var e=this;this.addListener("over",function(){e.ownerMenu.fireEvent("submenuover",e),e.subMenu&&e.delayShowSubMenu()}),this.subMenu&&(this.getDom().className+=" edui-hassubmenu",this.subMenu.render(),this.addListener("out",function(){e.delayHideSubMenu()}),this.subMenu.addListener("over",function(){clearTimeout(e._closingTimer),e._closingTimer=null,e.addState("opened")}),this.ownerMenu.addListener("hide",function(){e.hideSubMenu()}),this.ownerMenu.addListener("submenuover",function(t,n){n!==e&&e.delayHideSubMenu()}),this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide,this.subMenu.queryAutoHide=function(t){return t&&r.contains(e.getDom(),t)?!1:this._bakQueryAutoHide(t)}),this.getDom().style.tabIndex="-1",r.makeUnselectable(this.getDom()),this.Stateful_postRender()},delayShowSubMenu:function(){var e=this;e.isDisabled()||(e.addState("opened"),clearTimeout(e._showingTimer),clearTimeout(e._closingTimer),e._closingTimer=null,e._showingTimer=setTimeout(function(){e.showSubMenu()},250))},delayHideSubMenu:function(){var e=this;e.isDisabled()||(e.removeState("opened"),clearTimeout(e._showingTimer),e._closingTimer||(e._closingTimer=setTimeout(function(){e.hasState("opened")||e.hideSubMenu(),e._closingTimer=null},400)))},renderLabelHtml:function(){return'<div class="edui-arrow"></div><div class="edui-box edui-icon"></div><div class="edui-box edui-label %%-label">'+(this.label||"")+"</div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(e){if(this.subMenu&&this.hasState("opened"))return this.subMenu.queryAutoHide(e)},_onClick:function(e,t){if(this.hasState("disabled"))return;this.fireEvent("click",e,t)!==!1&&(this.subMenu?this.showSubMenu():s.postHide(e))},showSubMenu:function(){var e=r.getClientRect(this.getDom());e.right-=5,e.left+=2,e.width-=7,e.top-=4,e.bottom+=4,e.height+=8,this.subMenu.showAnchorRect(e,!0,!0)},hideSubMenu:function(){this.subMenu.hide()}},t.inherits(l,i),t.extend(l.prototype,o,!0)}(),function(){var t=e.editor.utils,n=e.editor.ui.uiUtils,r=e.editor.ui.Menu,i=e.editor.ui.SplitButton,s=e.editor.ui.Combox=function(e){this.initOptions(e),this.initCombox()};s.prototype={uiName:"combox",onbuttonclick:function(){this.showPopup()},initCombox:function(){var e=this;this.items=this.items||[];for(var t=0;t<this.items.length;t++){var n=this.items[t];n.uiName="listitem",n.index=t,n.onclick=function(){e.selectByIndex(this.index)}}this.popup=new r({items:this.items,uiName:"list",editor:this.editor,captureWheel:!0,combox:this}),this.initSplitButton()},_SplitButton_postRender:i.prototype.postRender,postRender:function(){this._SplitButton_postRender(),this.setLabel(this.label||""),this.setValue(this.initValue||"")},showPopup:function(){var e=n.getClientRect(this.getDom());e.top+=1,e.bottom-=1,e.height-=2,this.popup.showAnchorRect(e)},getValue:function(){return this.value},setValue:function(e){var t=this.indexByValue(e);t!=-1?(this.selectedIndex=t,this.setLabel(this.items[t].label),this.value=this.items[t].value):(this.selectedIndex=-1,this.setLabel(this.getLabelForUnknowValue(e)),this.value=e)},setLabel:function(e){this.getDom("button_body").innerHTML=e,this.label=e},getLabelForUnknowValue:function(e){return e},indexByValue:function(e){for(var t=0;t<this.items.length;t++)if(e==this.items[t].value)return t;return-1},getItem:function(e){return this.items[e]},selectByIndex:function(e){e<this.items.length&&this.fireEvent("select",e)!==!1&&(this.selectedIndex=e,this.value=this.items[e].value,this.setLabel(this.items[e].label))}},t.inherits(s,i)}(),function(){var t=e.editor.utils,n=e.editor.ui.Menu,r=e.editor.ui.SplitButton,i=e.editor.ui.MenuButton=function(e){this.initOptions(e),this.initMenuButton()};i.prototype={initMenuButton:function(){var e=this;this.uiName="menubutton",this.popup=new n({items:e.items,className:e.className,editor:e.editor}),this.popup.addListener("show",function(){var t=this;for(var n=0;n<t.items.length;n++)t.items[n].removeState("checked"),t.items[n].value==e._value&&(t.items[n].addState("checked"),this.value=e._value)}),this.initSplitButton()},setValue:function(e){this._value=e}},t.inherits(i,r)}(),function(){var t=e.editor.utils,n=e.editor.ui;n.buttons={};var r=["undo","redo","formatmatch","bold","italic","underline","fontborder","touppercase","tolowercase","strikethrough","subscript","superscript","source","indent","outdent","blockquote","pagebreak","selectall","print","horizontal","removeformat","time","date","unlink","insertparagraphbeforetable","insertrow","insertcol","mergeright","mergedown","deleterow","deletecol","splittorows","splittocols","splittocells","mergecells","deletetable","drafts","uploadimages","uploadvideo"];for(var i=0,s;s=r[i++];)s=s.toLowerCase(),n[s]=function(e){return function(t){var r=new n.Button({className:"edui-for-"+e,title:t.options.labelMap[e]||t.getLang("labelMap."+e)||"",onclick:function(){t.execCommand(e)},theme:t.options.theme,showText:!1});return n.buttons[e]=r,t.addListener("selectionchange",function(n,i,s){var o=t.queryCommandState(e);o==-1?(r.setDisabled(!0),r.setChecked(!1)):s||(r.setDisabled(!1),r.setChecked(o))}),r}}(s);var o={justify:["left","right","center","justify"],imagefloat:["none","left","center","right"],directionality:["ltr","rtl"]};for(var u in o)(function(e,t){for(var r=0,i;i=t[r++];)(function(t){n[e.replace("float","")+t]=function(r){var i=new n.Button({className:"edui-for-"+e.replace("float","")+t,title:r.options.labelMap[e.replace("float","")+t]||r.getLang("labelMap."+e.replace("float","")+t)||"",theme:r.options.theme,onclick:function(){r.execCommand(e,t)}});return n.buttons[e]=i,r.addListener("selectionchange",function(n,s,o){i.setDisabled(r.queryCommandState(e)==-1),i.setChecked(r.queryCommandValue(e)==t&&!o)}),i}})(i)})(u,o[u]);n.fontfamily=function(e,r,i){r=e.options.fontfamily||[],i=e.options.labelMap.fontfamily||e.getLang("labelMap.fontfamily")||"";if(!r.length)return;for(var s=0,o,u=[];o=r[s];s++){var a=e.getLang("fontfamily")[o.name]||"";(function(n,r){u.push({label:n,value:r,theme:e.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+t.unhtml(this.value)+'">'+(this.label||"")+"</div>"}})})(o.label||a,o.val)}var f=new n.Combox({editor:e,items:u,onselect:function(t,n){e.execCommand("FontFamily",this.items[n].value)},onbuttonclick:function(){this.showPopup()},title:i,initValue:i,className:"edui-for-fontfamily",indexByValue:function(e){if(e)for(var t=0,n;n=this.items[t];t++)if(n.value.indexOf(e)!=-1)return t;return-1}});return n.buttons.fontfamily=f,e.addListener("selectionchange",function(t,n,r){if(!r){var i=e.queryCommandState("FontFamily");if(i==-1)f.setDisabled(!0);else{f.setDisabled(!1);var s=e.queryCommandValue("FontFamily");s&&(s=s.replace(/['"]/g,"").split(",")[0]),f.setValue(s)}}}),f},n.fontsize=function(e,t,r){r=e.options.labelMap.fontsize||e.getLang("labelMap.fontsize")||"",t=t||e.options.fontsize||[];if(!t.length)return;var i=[];for(var s=0;s<t.length;s++){var o=t[s]+"px";i.push({label:o,value:o,theme:e.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="line-height:1;font-size:'+this.value+'">'+(this.label||"")+"</div>"}})}var u=new n.Combox({editor:e,items:i,title:r,initValue:r,onselect:function(t,n){e.execCommand("FontSize",this.items[n].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"});return n.buttons.fontsize=u,e.addListener("selectionchange",function(t,n,r){if(!r){var i=e.queryCommandState("FontSize");i==-1?u.setDisabled(!0):(u.setDisabled(!1),u.setValue(e.queryCommandValue("FontSize")))}}),u}}(),function(){function o(e){this.initOptions(e),this.initEditorUI()}var t=e.editor.utils,n=e.editor.ui.uiUtils,r=e.editor.ui.UIBase,i=e.editor.dom.domUtils,s=[];o.prototype={uiName:"editor",initEditorUI:function(){function r(e,t){e.setOpt({wordCount:!0,maximumWords:1e4,wordCountMsg:e.options.wordCountMsg||e.getLang("wordCountMsg"),wordOverFlowMsg:e.options.wordOverFlowMsg||e.getLang("wordOverFlowMsg")});var n=e.options,r=n.maximumWords,i=n.wordCountMsg,s=n.wordOverFlowMsg,o=t.getDom("wordcount");if(!n.wordCount)return;var u=e.getContentLength(!0);u>r?(o.innerHTML=s,e.fireEvent("wordcountoverflow")):o.innerHTML=i.replace("{#leave}",r-u).replace("{#count}",u)}this.editor.ui=this,this.initUIBase(),this._initToolbars();var t=this.editor,n=this;t.addListener("ready",function(){i.on(t.window,"scroll",function(t){e.editor.ui.Popup.postHide(t)}),t.ui._actualFrameWidth=t.options.initialFrameWidth,UE.browser.ie&&UE.browser.version===6&&t.container.ownerDocument.execCommand("BackgroundImageCache",!1,!0);if(t.options.wordCount){function s(){r(t,n),i.un(t.document,"click",arguments.callee)}i.on(t.document,"click",s),t.ui.getDom("wordcount").innerHTML=t.getLang("wordCountTip")}if(!t.selection.isFocus())return;t.fireEvent("selectionchange",!1,!0)}),t.addListener("mousedown",function(t,n){var r=n.target||n.srcElement;e.editor.ui.Popup.postHide(n,r)}),t.addListener("wordcount",function(e){r(this,n)})},_initToolbars:function(){var t=this.editor,n=this.toolbars||[],r=[];for(var i=0;i<n.length;i++){var s=n[i],o=new e.editor.ui.Toolbar({theme:t.options.theme});for(var u=0;u<s.length;u++){var a=s[u],f=null;typeof a=="string"?(a=a.toLowerCase(),a=="|"&&(a="Separator"),e.editor.ui[a]&&(f=new e.editor.ui[a](t))):f=a,f&&f.id&&o.add(f)}r[i]=o}this.toolbars=r},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox">'+(this.toolbars.length?'<div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+"</div></div>":"")+'<div id="##_message_holder" class="%%-messageholder"></div>'+'<div id="##_tip" class="pages-success dn"></div>'+"</div>"+'<div id="##_iframeholder" class="%%-iframeholder">'+"</div>"+'<div id="##_bottombar" class="%%-bottomContainer" style="overflow: hidden;"><table style="height:auto;"><tr>'+'<td id="##_wordcount" class="%%-wordcount"></td>'+"</tr></table></div>"+"</div>"},showWordImageDialog:function(){this._dialogs.wordimageDialog.open()},renderToolbarBoxHtml:function(){var e=[];for(var t=0;t<this.toolbars.length;t++)e.push(this.toolbars[t].renderHtml());return e.join("")},postRender:function(){r.prototype.postRender.call(this);for(var e=0;e<this.toolbars.length;e++)this.toolbars[e].postRender()},showToolbarMsg:function(e,t){this.getDom("toolbarmsg_label").innerHTML=e,this.getDom("toolbarmsg").style.display="";if(!t){var n=this.getDom("upload_dialog");n.style.display="none"}},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(e){return e?e.replace("~/",this.editor.options.UEDITOR_HOME_URL||""):""},triggerLayout:function(){var e=this.getDom();e.style.zoom=="1"?e.style.zoom="100%":e.style.zoom="1"}},t.inherits(o,e.editor.ui.UIBase);var u={};UE.ui.Editor=function(e){var n=new UE.Editor(e);n.options.editor=n,t.loadFile(document,{href:n.options.themePath+n.options.theme+"/css/ueditor.css",tag:"link",type:"text/css",rel:"stylesheet"});var r=n.render;return n.render=function(e){e.constructor===String&&(n.key=e,u[e]=n),t.domReady(function(){function t(){n.setOpt({labelMap:n.options.labelMap||n.getLang("labelMap")}),new o(n.options);if(e){e.constructor===String&&(e=document.getElementById(e)),e&&e.getAttribute("name")&&(n.options.textarea=e.getAttribute("name"));if(e&&/script|textarea/ig.test(e.tagName)){var t=document.createElement("div");e.parentNode.insertBefore(t,e);var s=e.value||e.innerHTML;n.options.initialContent=/^[\t\r\n ]*$/.test(s)?n.options.initialContent:s.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><"),e.className&&(t.className=e.className),e.style.cssText&&(t.style.cssText=e.style.cssText),/textarea/i.test(e.tagName)?(n.textarea=e,n.textarea.style.display="none"):e.parentNode.removeChild(e),e.id&&(t.id=e.id,i.removeAttributes(e,"id")),e=t,e.innerHTML=""}}i.addClass(e,"edui-"+n.options.theme),n.ui.render(e);var u=n.options;n.container=n.ui.getDom();var a=i.findParents(e,!0),f=[];for(var l=0,c;c=a[l];l++)f[l]=c.style.display,c.style.display="block";if(u.initialFrameWidth)u.minFrameWidth=u.initialFrameWidth;else{u.minFrameWidth=u.initialFrameWidth=e.offsetWidth;var h=e.style.width;/%$/.test(h)&&(u.initialFrameWidth=h)}u.initialFrameHeight?u.minFrameHeight=u.initialFrameHeight:u.initialFrameHeight=u.minFrameHeight=e.offsetHeight;for(var l=0,c;c=a[l];l++)c.style.display=f[l];e.style.height&&(e.style.height=""),n.container.style.width=u.initialFrameWidth+(/%$/.test(u.initialFrameWidth)?"":"px"),n.container.style.zIndex=u.zIndex,r.call(n,n.ui.getDom("iframeholder")),n.fireEvent("afteruiready")}n.langIsReady?t():n.addListener("langReady",t)})},n},UE.getEditor=function(e,t){var n=u[e];return n||(n=u[e]=new UE.ui.Editor(t),n.render(e)),n},UE.delEditor=function(e){var t;if(t=u[e])t.key&&t.destroy(),delete u[e]}}()})();